<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>Set-up the Passive Peer | Couchbase Docs</title>
<link rel="canonical" href="https://ibsoln.github.io/stage/DOC-6720/couchbase-lite/2.8/swift/advance/swift-p2psync-websocket-using-passive.html">
<link rel="stylesheet" href="../../../../_/css/site.css">
<script src="../../../../_/js/vendor/jquery.js"></script>
<meta name="description" content="Couchbase Lite - this content covers how to set up a passive peer ready to replicate Couchbase Lite database changes using peer-to-peer sync over websockets">
<link rel="schema.dcterms" href="https://purl.org/dc/terms/">
<meta name="dcterms.subject" content="couchbase-lite">
<meta name="dcterms.identifier" content="2.8">
<meta name="generator" content="Antora 2.3.3">
<link rel="icon" href="../../../../_/img/favicon.ico" type="image/x-icon">
</head>
<body class="article">
<header class="header fixed-top">
  <div class="header-top-row">
      <div class="container">
          <nav class="navbar navbar-expand-md flex-nowrap justify-content-between navbar-new-top">

              <a class="navbar-brand" href="../../../..">
                <img src="../../../../_/img/couchbase-documentation-logo.svg" alt="Couchbase" />
              </a>
              <button class="navbar-burger" data-target="topbar-menu">
                <span></span>
                <span></span>
                <span></span>
              </button>

          </nav>
      </div>
  </div>
  <div class="header-bottom-row" id="topbar-menu">
    <div class="container">
        <nav  class="navbar navbar-new-bottom">

              <div class="navbar-collapse collapse" id="navbar2">
                <ul class="navbar-nav w-100 justify-content-start">
                  <li class="nav-item">
                    <a class="nav-link" href="../../../../home/server.html">
                      Server
                    </a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="../../../../home/mobile.html">
                      Mobile
                    </a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="../../../../home/cloud.html">
                      Cloud
                    </a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="#">
                      SDKs
                    </a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="#">
                      Tutorials
                      <span class="arrow">
                        <i class="fas fa-arrow-right"></i>
                      </span>
                    </a>
                  </li>
                </ul>
              </div>
              <div class="primary-action">
                <form class="navbar-item search">
                  <input type="text" placeholder="Search Docs" class="query" id="search-query" />
                  <button type="button" class="search-btn">
                    <i class="fas fa-search"></i>
                  </button>
                </form>
                <div class="parent-site">
                  <a href="https://www.couchbase.com">
                    Couchbase.com
                  </a>
                </div>
                <a class="btn btn-primary try-btn" href="https://www.couchbase.com/downloads">
                  Try Free
                </a>
              </div>

        </nav>
    </div>
   </div>
</header>
<div class="body container">
<nav class="nav">
<div class="left-sidebar-menu">
<div class="version-control-box">
<div class="component-frame">
<div class="frame-icon">
<img src="../../../../_/img/server-icon.png" alt="">
</div>
<div class="frame-body">
<h4 class="title"><span class="">GaStg/90120-1</span></h4>
<a class="navbar-item component" href="../../index.html"> <span class="version">2.8</span></a>
</div>
</div>
</div>
<div class="nav-menu">
<div class="main-nav-parent new " data-depth="0">
<span class="back-to-menu"><i class="fas fa-chevron-left"></i> Main Menu </span>
</div>
<ul class="nav-list">
<li class="nav-item " data-depth="0">

<span class="nav-line "  data-depth="0">
<span class="in-toggle" data-depth="0"></span>
<a class="nav-link" href="../../introduction.html">Introduction</a>
</span>
<ul class="nav-list">
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<a class="nav-link" href="../../csharp/advance/csharp-p2psync-websocket-using-passive.html">Passive Peer</a>
</span>
</li>
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<a class="nav-link" href="../../csharp/advance/csharp-p2psync-websocket-using-active.html">Active Peer</a>
</span>
</li>
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<a class="nav-link" href="https://ibsoln.github.io/stage/api/mobile/2.8.0/couchbase-lite-net/api/Couchbase.Lite">API References</a>
</span>
</li>
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<a class="nav-link" href="../../csharp/learn/csharp-p2psync.html">about p2p</a>
</span>
</li>
</ul>
</li>
<li class="nav-item " data-depth="0">

<span class="nav-line "  data-depth="0">
<span class="in-toggle" data-depth="0"></span>
<span class="nav-text ">C#.Net</span>
</span>
<ul class="nav-list">
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<span class="in-toggle" data-depth="1"></span>
<span class="nav-text ">Start</span>
</span>
<ul class="nav-list">
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../../csharp/start/csharp-gs-prereqs.html">Prerequisites</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="#couchbase-lite:csharp:start/csharp-gs-install.adoc">Install</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="#couchbase-lite:csharp:start/csharp-gs-build.adoc">Test Build</a>
</span>
</li>
</ul>
</li>
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<span class="in-toggle" data-depth="1"></span>
<span class="nav-text ">Next</span>
</span>
<ul class="nav-list">
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="#couchbase-lite:csharp:next/csharp-dbo-crud.adoc">Using CRUD Operations</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="#couchbase-lite:csharp:next/csharp-dbo-query.adoc">Using Query Operations</a>
</span>
</li>
</ul>
</li>
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<span class="in-toggle" data-depth="1"></span>
<span class="nav-text ">Advance</span>
</span>
<ul class="nav-list">
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<span class="in-toggle" data-depth="2"></span>
<span class="nav-text ">Peer-to-Peer Sync</span>
</span>
<ul class="nav-list">
<li class="nav-item " data-depth="3">

<span class="nav-line "  data-depth="3">
<a class="nav-link" href="../../csharp/advance/csharp-p2psync-websocket-using-passive.html">Passive Peer</a>
</span>
</li>
<li class="nav-item " data-depth="3">

<span class="nav-line "  data-depth="3">
<a class="nav-link" href="../../csharp/advance/csharp-p2psync-websocket-using-active.html">Active Peer</a>
</span>
</li>
<li class="nav-item " data-depth="3">

<span class="nav-line "  data-depth="3">
<a class="nav-link" href="#couchbase-lite:csharp:advance/csharp-p2p-managing-tls-id.adoc">Manage TLS Identities</a>
</span>
</li>
</ul>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../../csharp/advance/csharp-dep-upgrade.html">Upgrading</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="#couchbase-lite:csharp:advance/csharp-troubleshooting.adoc">Troubleshooting</a>
</span>
</li>
</ul>
</li>
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<span class="in-toggle" data-depth="1"></span>
<span class="nav-text ">Learn</span>
</span>
<ul class="nav-list">
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../../csharp/learn/csharp-database.html">Working with Databases</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../../csharp/learn/csharp-document.html">Working with Documents</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../../csharp/learn/csharp-blob.html">Working with Blobs</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<span class="in-toggle" data-depth="2"></span>
<a class="nav-link" href="../../csharp/learn/csharp-query.html">Working with Queries</a>
</span>
<ul class="nav-list">
<li class="nav-item " data-depth="3">

<span class="nav-line "  data-depth="3">
<a class="nav-link" href="#couchbase-lite:csharp:learn/csharp-query-live.adoc">Live Queries</a>
</span>
</li>
<li class="nav-item " data-depth="3">

<span class="nav-line "  data-depth="3">
<a class="nav-link" href="#couchbase-lite:csharp:learn/csharp-query-predictive.adoc">Predictive Queries</a>
</span>
</li>
<li class="nav-item " data-depth="3">

<span class="nav-line "  data-depth="3">
<a class="nav-link" href="../../csharp/learn/csharp-fts.html">Running Full-text Searches</a>
</span>
</li>
</ul>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../../csharp/learn/csharp-indexing.html">Indexing</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../../csharp/learn/csharp-replication.html">Sync Gateway Replications</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../../csharp/learn/csharp-dbreplica.html">Inter Database Replicaton</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../../csharp/learn/csharp-conflict.html">Handling Conflicts</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<span class="in-toggle" data-depth="2"></span>
<a class="nav-link" href="../../csharp/learn/csharp-p2psync.html">Peer-to-peer Synchronization</a>
</span>
<ul class="nav-list">
<li class="nav-item " data-depth="3">

<span class="nav-line "  data-depth="3">
<a class="nav-link" href="../../csharp/learn/csharp-p2psync-websocket.html">Peer-to-peer sync over web sockets</a>
</span>
</li>
<li class="nav-item " data-depth="3">

<span class="nav-line "  data-depth="3">
<a class="nav-link" href="#couchbase-lite:csharp:learn/csharp-p2psync-custom.adoc">Peer-to-peer sync (custom)</a>
</span>
</li>
</ul>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="#couchbase-lite:csharp:learn/csharp-thread-safety.adoc">Thread-safety</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="#couchbase-lite:csharp:learn/csharp-cert-pinning.adoc">Certificate Pinning</a>
</span>
</li>
</ul>
</li>
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<span class="in-toggle" data-depth="1"></span>
<span class="nav-text ">Refer</span>
</span>
<ul class="nav-list">
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="https://ibsoln.github.io/stage/api/mobile/2.8.0/couchbase-lite-net/api/Couchbase.Lite">API References</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../../refer-glossary.html">Glossary</a>
</span>
</li>
</ul>
</li>
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<span class="in-toggle" data-depth="1"></span>
<span class="nav-text ">Product Notes</span>
</span>
<ul class="nav-list">
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="#couchbase-lite:csharp:product/csharp-releasenotes.adoc">Release Notes</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="#couchbase-lite:csharp:product/csharp-pn-supportnotes.adoc">Support Notices</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../../compatibility.html">Compatibility</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="#couchbase-lite:csharp:product/csharp-changelog.adoc">Change Log</a>
</span>
</li>
</ul>
</li>
</ul>
</li>
<li class="nav-item " data-depth="0">

<span class="nav-line "  data-depth="0">
<span class="in-toggle" data-depth="0"></span>
<span class="nav-text ">Android (Java)</span>
</span>
<ul class="nav-list">
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<span class="in-toggle" data-depth="1"></span>
<span class="nav-text ">Start</span>
</span>
<ul class="nav-list">
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../../android/start/java-android-gs-prereqs.html">Prerequisites</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../../android/start/java-android-gs-install.html">Install</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../../android/start/java-android-gs-build.html">Test Build</a>
</span>
</li>
</ul>
</li>
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<span class="in-toggle" data-depth="1"></span>
<span class="nav-text ">Next</span>
</span>
<ul class="nav-list">
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../../android/next/java-android-dbo-crud.html">Using CRUD Operations</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../../android/next/java-android-dbo-query.html">Using Query Operations</a>
</span>
</li>
</ul>
</li>
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<span class="in-toggle" data-depth="1"></span>
<span class="nav-text ">Advance</span>
</span>
<ul class="nav-list">
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<span class="in-toggle" data-depth="2"></span>
<span class="nav-text ">Peer-to-Peer Sync</span>
</span>
<ul class="nav-list">
<li class="nav-item " data-depth="3">

<span class="nav-line "  data-depth="3">
<a class="nav-link" href="../../android/advance/java-android-p2psync-websocket-using-passive.html">Passive Peer</a>
</span>
</li>
<li class="nav-item " data-depth="3">

<span class="nav-line "  data-depth="3">
<a class="nav-link" href="../../android/advance/java-android-p2psync-websocket-using-active.html">Active Peer</a>
</span>
</li>
<li class="nav-item " data-depth="3">

<span class="nav-line "  data-depth="3">
<a class="nav-link" href="../../android/advance/java-android-p2p-managing-tls-id.html">Manage TLS Identities</a>
</span>
</li>
</ul>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../../android/advance/java-android-dep-upgrade.html">Upgrading</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../../android/advance/java-android-troubleshooting.html">Troubleshooting</a>
</span>
</li>
</ul>
</li>
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<span class="in-toggle" data-depth="1"></span>
<span class="nav-text ">Learn</span>
</span>
<ul class="nav-list">
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../../android/learn/java-android-database.html">Working with Databases</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../../android/learn/java-android-document.html">Working with Documents</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../../android/learn/java-android-blob.html">Working with Blobs</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<span class="in-toggle" data-depth="2"></span>
<a class="nav-link" href="../../android/learn/java-android-query.html">Working with Queries</a>
</span>
<ul class="nav-list">
<li class="nav-item " data-depth="3">

<span class="nav-line "  data-depth="3">
<a class="nav-link" href="../../android/learn/java-android-query-live.html">Live Queries</a>
</span>
</li>
<li class="nav-item " data-depth="3">

<span class="nav-line "  data-depth="3">
<a class="nav-link" href="../../android/learn/java-android-query-predictive.html">Predictive Queries</a>
</span>
</li>
<li class="nav-item " data-depth="3">

<span class="nav-line "  data-depth="3">
<a class="nav-link" href="../../android/learn/java-android-fts.html">Running Full-text Searches</a>
</span>
</li>
</ul>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../../android/learn/java-android-indexing.html">Indexing</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../../android/learn/java-android-replication.html">Sync Gateway Replications</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../../android/learn/java-android-dbreplica.html">Inter Database Replicaton</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../../android/learn/java-android-conflict.html">Handling Conflicts</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<span class="in-toggle" data-depth="2"></span>
<a class="nav-link" href="../../android/learn/java-android-p2psync.html">Peer-to-peer Synchronization</a>
</span>
<ul class="nav-list">
<li class="nav-item " data-depth="3">

<span class="nav-line "  data-depth="3">
<a class="nav-link" href="../../android/learn/java-android-p2psync-websocket.html">Peer-to-peer sync over web sockets</a>
</span>
</li>
<li class="nav-item " data-depth="3">

<span class="nav-line "  data-depth="3">
<a class="nav-link" href="../../android/learn/java-android-p2psync-custom.html">Peer-to-peer sync (custom)</a>
</span>
</li>
</ul>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../../android/learn/java-android-thread-safety.html">Thread-safety</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../../android/learn/java-android-cert-pinning.html">Certificate Pinning</a>
</span>
</li>
</ul>
</li>
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<span class="in-toggle" data-depth="1"></span>
<span class="nav-text ">Refer</span>
</span>
<ul class="nav-list">
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="https://ibsoln.github.io/stage/api/mobile/2.8.0/couchbase-lite-android">API References</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../../refer-glossary.html">Glossary</a>
</span>
</li>
</ul>
</li>
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<span class="in-toggle" data-depth="1"></span>
<span class="nav-text ">Product Notes</span>
</span>
<ul class="nav-list">
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../../android/product/java-android-releasenotes.html">Release Notes</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../../android/product/java-android-pn-supportnotes.html">Support Notices</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../../compatibility.html">Compatibility</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="#couchbase-lite:android:product/java-android-changelog.adoc">Change Log</a>
</span>
</li>
</ul>
</li>
</ul>
</li>
<li class="nav-item " data-depth="0">

<span class="nav-line "  data-depth="0">
<span class="in-toggle" data-depth="0"></span>
<span class="nav-text ">Objective C</span>
</span>
<ul class="nav-list">
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<span class="in-toggle" data-depth="1"></span>
<span class="nav-text ">Start</span>
</span>
<ul class="nav-list">
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../../objc/start/objc-gs-prereqs.html">Prerequisites</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../../objc/start/objc-gs-install.html">Install</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../../objc/start/objc-gs-build.html">Test Build</a>
</span>
</li>
</ul>
</li>
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<span class="in-toggle" data-depth="1"></span>
<span class="nav-text ">Next</span>
</span>
<ul class="nav-list">
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../../objc/next/objc-dbo-crud.html">Using CRUD Operations</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../../objc/next/objc-dbo-query.html">Using Query Operations</a>
</span>
</li>
</ul>
</li>
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<span class="in-toggle" data-depth="1"></span>
<span class="nav-text ">Advance</span>
</span>
<ul class="nav-list">
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<span class="in-toggle" data-depth="2"></span>
<span class="nav-text ">Peer-to-Peer Sync</span>
</span>
<ul class="nav-list">
<li class="nav-item " data-depth="3">

<span class="nav-line "  data-depth="3">
<a class="nav-link" href="../../objc/advance/objc-p2psync-websocket-using-passive.html">Passive Peer</a>
</span>
</li>
<li class="nav-item " data-depth="3">

<span class="nav-line "  data-depth="3">
<a class="nav-link" href="../../objc/advance/objc-p2psync-websocket-using-active.html">Active Peer</a>
</span>
</li>
<li class="nav-item " data-depth="3">

<span class="nav-line "  data-depth="3">
<a class="nav-link" href="../../objc/advance/objc-p2p-managing-tls-id.html">Manage TLS Identities</a>
</span>
</li>
</ul>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../../objc/advance/objc-dep-upgrade.html">Upgrading</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../../objc/advance/objc-troubleshooting.html">Troubleshooting</a>
</span>
</li>
</ul>
</li>
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<span class="in-toggle" data-depth="1"></span>
<span class="nav-text ">Learn</span>
</span>
<ul class="nav-list">
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../../objc/learn/objc-database.html">Working with Databases</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../../objc/learn/objc-document.html">Working with Documents</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../../objc/learn/objc-blob.html">Working with Blobs</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<span class="in-toggle" data-depth="2"></span>
<a class="nav-link" href="../../objc/learn/objc-query.html">Working with Queries</a>
</span>
<ul class="nav-list">
<li class="nav-item " data-depth="3">

<span class="nav-line "  data-depth="3">
<a class="nav-link" href="../../objc/learn/objc-query-live.html">Live Queries</a>
</span>
</li>
<li class="nav-item " data-depth="3">

<span class="nav-line "  data-depth="3">
<a class="nav-link" href="../../objc/learn/objc-query-predictive.html">Predictive Queries</a>
</span>
</li>
<li class="nav-item " data-depth="3">

<span class="nav-line "  data-depth="3">
<a class="nav-link" href="../../objc/learn/objc-fts.html">Running Full-text Searches</a>
</span>
</li>
</ul>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../../objc/learn/objc-indexing.html">Indexing</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../../objc/learn/objc-replication.html">Sync Gateway Replications</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../../objc/learn/objc-dbreplica.html">Inter Database Replicaton</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../../objc/learn/objc-conflict.html">Handling Conflicts</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<span class="in-toggle" data-depth="2"></span>
<a class="nav-link" href="../../objc/learn/objc-p2psync.html">Peer-to-peer Synchronization</a>
</span>
<ul class="nav-list">
<li class="nav-item " data-depth="3">

<span class="nav-line "  data-depth="3">
<a class="nav-link" href="../../objc/learn/objc-p2psync-websocket.html">Peer-to-peer sync over web sockets</a>
</span>
</li>
<li class="nav-item " data-depth="3">

<span class="nav-line "  data-depth="3">
<a class="nav-link" href="../../objc/learn/objc-p2psync-custom.html">Peer-to-peer sync (custom)</a>
</span>
</li>
</ul>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../../objc/learn/objc-thread-safety.html">Thread-safety</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../../objc/learn/objc-cert-pinning.html">Certificate Pinning</a>
</span>
</li>
</ul>
</li>
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<span class="in-toggle" data-depth="1"></span>
<span class="nav-text ">Refer</span>
</span>
<ul class="nav-list">
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="https://ibsoln.github.io/stage/api/mobile/2.8.0/couchbase-lite-objc">API References</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../../refer-glossary.html">Glossary</a>
</span>
</li>
</ul>
</li>
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<span class="in-toggle" data-depth="1"></span>
<span class="nav-text ">Product Notes</span>
</span>
<ul class="nav-list">
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../../objc/product/objc-releasenotes.html">Release Notes</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="#couchbase-lite:objc:product/objc-pn-supportnotes.adoc">Support Notices</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../../compatibility.html">Compatibility</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="#couchbase-lite:objc:product/objc-changelog.adoc">Change Log</a>
</span>
</li>
</ul>
</li>
</ul>
</li>
<li class="nav-item is-current-path is-active is-active-depth-2  " data-depth="0">

<span class="nav-line "  data-depth="0">
<span class="in-toggle" data-depth="0"></span>
<span class="nav-text ">Swift</span>
</span>
<ul class="nav-list">
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<span class="in-toggle" data-depth="1"></span>
<span class="nav-text ">Start</span>
</span>
<ul class="nav-list">
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../start/swift-gs-prereqs.html">Prerequisites</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../start/swift-gs-install.html">Install</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../start/swift-gs-build.html">Test Build</a>
</span>
</li>
</ul>
</li>
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<span class="in-toggle" data-depth="1"></span>
<span class="nav-text ">Next</span>
</span>
<ul class="nav-list">
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../next/swift-dbo-crud.html">Using CRUD Operations</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../next/swift-dbo-query.html">Using Query Operations</a>
</span>
</li>
</ul>
</li>
<li class="nav-item is-current-path is-active is-active-depth-2  " data-depth="1">

<span class="nav-line "  data-depth="1">
<span class="in-toggle" data-depth="1"></span>
<span class="nav-text ">Advance</span>
</span>
<ul class="nav-list">
<li class="nav-item is-current-path is-active is-active-depth-2  " data-depth="2">

<span class="nav-line "  data-depth="2">
<span class="in-toggle" data-depth="2"></span>
<span class="nav-text ">Peer-to-Peer Sync</span>
</span>
<ul class="nav-list">
<li class="nav-item is-current-page is-active is-active-depth-2  " data-depth="3">

<span class="nav-line "  data-depth="3">
<a class="nav-link" href="swift-p2psync-websocket-using-passive.html">Passive Peer</a>
</span>
</li>
<li class="nav-item " data-depth="3">

<span class="nav-line "  data-depth="3">
<a class="nav-link" href="swift-p2psync-websocket-using-active.html">Active Peer</a>
</span>
</li>
<li class="nav-item " data-depth="3">

<span class="nav-line "  data-depth="3">
<a class="nav-link" href="swift-p2p-managing-tls-id.html">Manage TLS Identities</a>
</span>
</li>
</ul>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="swift-dep-upgrade.html">Upgrading</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="swift-troubleshooting.html">Troubleshooting</a>
</span>
</li>
</ul>
</li>
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<span class="in-toggle" data-depth="1"></span>
<span class="nav-text ">Learn</span>
</span>
<ul class="nav-list">
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../learn/swift-database.html">Working with Databases</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../learn/swift-document.html">Working with Documents</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../learn/swift-blob.html">Working with Blobs</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<span class="in-toggle" data-depth="2"></span>
<a class="nav-link" href="../learn/swift-query.html">Working with Queries</a>
</span>
<ul class="nav-list">
<li class="nav-item " data-depth="3">

<span class="nav-line "  data-depth="3">
<a class="nav-link" href="../learn/swift-query-live.html">Live Queries</a>
</span>
</li>
<li class="nav-item " data-depth="3">

<span class="nav-line "  data-depth="3">
<a class="nav-link" href="../learn/swift-query-predictive.html">Predictive Queries</a>
</span>
</li>
<li class="nav-item " data-depth="3">

<span class="nav-line "  data-depth="3">
<a class="nav-link" href="../learn/swift-fts.html">Running Full-text Searches</a>
</span>
</li>
</ul>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../learn/swift-indexing.html">Indexing</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../learn/swift-replication.html">Sync Gateway Replications</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../learn/swift-dbreplica.html">Inter Database Replicaton</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../learn/swift-conflict.html">Handling Conflicts</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<span class="in-toggle" data-depth="2"></span>
<a class="nav-link" href="../learn/swift-p2psync.html">Peer-to-peer Synchronization</a>
</span>
<ul class="nav-list">
<li class="nav-item " data-depth="3">

<span class="nav-line "  data-depth="3">
<a class="nav-link" href="../learn/swift-p2psync-websocket.html">Peer-to-peer sync over web sockets</a>
</span>
</li>
<li class="nav-item " data-depth="3">

<span class="nav-line "  data-depth="3">
<a class="nav-link" href="../learn/swift-p2psync-custom.html">Peer-to-peer sync (custom)</a>
</span>
</li>
</ul>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../learn/swift-thread-safety.html">Thread-safety</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../learn/swift-cert-pinning.html">Certificate Pinning</a>
</span>
</li>
</ul>
</li>
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<span class="in-toggle" data-depth="1"></span>
<span class="nav-text ">Refer</span>
</span>
<ul class="nav-list">
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="https://ibsoln.github.io/stage/api/mobile/2.8.0/couchbase-lite-swift">API References</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../../refer-glossary.html">Glossary</a>
</span>
</li>
</ul>
</li>
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<span class="in-toggle" data-depth="1"></span>
<span class="nav-text ">Product Notes</span>
</span>
<ul class="nav-list">
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../product/swift-releasenotes.html">Release Notes</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="#couchbase-lite:swift:product/swift-pn-supportnotes.adoc">Support Notices</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../../compatibility.html">Compatibility</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../product/swift-changelog.html">Change Log</a>
</span>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<a href="#" class="menu-expand-toggle"> <span>Navigation</span> <i class="fas fa-times-circle"></i> <i class="fas fa-chevron-circle-left"></i></a>
</div></nav>
<aside class="toc sidebar">
  <div class="sidebar-box">
      <div class="tools" role="navigation">
<ul>
<li class="tool edit"><a href="file:///Users/ianbridge/CouchbaseDocs/bau/cbl/modules/swift/pages/advance/swift-p2psync-websocket-using-passive.adoc" title="Edit Page" target="_blank" rel="noopener">Edit on GitHub</a></li>
</ul>
</div>
      <div class="toc-menu"></div>
        <div class="is-this-helpful-box">
          <h4> Is this page helpful?</h4>
            <div class="btn-row">
              <a href="#" class="like-btn helpful-btn" id="yesBtn" data-page-rating="like" >
                     <i class="far fa-thumbs-up"></i>
                 Yes

                 </a>
              <a href="#" class="dislike-btn helpful-btn" id="noBtn"  data-page-rating="dislike"> <i class="far fa-thumbs-down"></i> No</a>
            </div>
            <div class="any-feedback">
              <a href="#" class="btn any-feedback-btn" id="myCustomTrigger">Leave Additional Feedback? </a>
            </div>
            <div class="dialog-box" id="dialogBox">
              <form>
                  <div class="form-group " id="additionalFeedbackBox">
                    <textarea class="input-control feed-back-msg" rows="8" placeholder="Any Additonal Feedback?"></textarea>

                    <div class="action-btn-row ">
                      <a href="#" class="skip-btn" id="skipBtnMsg">Skip</a>
                       <button class="submit-btn btn blue-btn disabled" > Submit  </button>
                       <a href="#" class="info-btn"><i class="fas fa-info-circle"></i></a>
                    </div>


                  </div>

              </form>

            </div>
      </div>
   </div>

</aside>

<div class="feedback-modal modal-popup">
  <div class="modal-popup-dialogue">
    <div class="popup-header">
      <a href="#" class="close-popup"><i class="fa fa-times"></i></a>
    </div>
    <div class="popup-content">
      <p>
        Please use the form below to provide your feedback. Because your feedback is valuable to us,
         the information you submit in this form is recorded in our issue tracking system (JIRA), which is publicly available.
        You can track the status of your feedback using the ticket number displayed in the dialog once you submit the form.
      </p>
    </div>
  </div>
</div>

<main class="article" data-ceiling="topbar">
<div class="article-header">
<button class="nav-control"></button>
<nav class="crumbs" aria-label="breadcrumbs">
<ul>
<li class="crumb"><a href="../../index.html">GaStg/90120-1</a></li>
<li class="crumb">Swift</li>
<li class="crumb">Advance</li>
<li class="crumb">Peer-to-Peer Sync</li>
<li class="crumb"><a href="swift-p2psync-websocket-using-passive.html">Passive Peer</a></li>
</ul>
</nav>
</div>
<article class="doc">
<div class="page-heading-title">
<h1 class="page">Set-up the Passive Peer</h1>
<div class="labels">
<ul>
<li class="edition"><a href="https://www.couchbase.com/products/editions">Enterprise</a></li>
<li class="status"><span>stage -- {release-comments-cbl}</span></li>
</ul>
</div>
</div>
<div class="contributor-list-box">
<span class="last-commit-date" id="commitdate">    </span>
<ul id="contributorList"></ul>
<span  id="otherContributor"> + </span>
</div><div id="preamble">
<div class="sectionbody">
<div class="quoteblock abstract">
<blockquote>
<div class="paragraph">
<p>Topic Group&#8201;&#8212;&#8201;<em>Peer-to-Peer Synchronization</em><br>
Description&#8201;&#8212;&#8201;<em>Couchbase Lite - this content covers how to set up a passive peer ready to replicate Couchbase Lite database changes using peer-to-peer sync over websockets</em><br>
Abstract&#8201;&#8212;&#8201;<em>How to set up a Listener to accept a Replicator connection and sync using peer-to-peer</em><br>
Related Content&#8201;&#8212;&#8201;<a href="https://ibsoln.github.io/stage/api/mobile/2.8.0/couchbase-lite-swift">API Reference</a>  |  <a href="swift-p2psync-websocket-using-passive.html" class="page">Passive Peer</a>  |  <a href="swift-p2psync-websocket-using-active.html" class="page">Active Peer</a></p>
</div>
</blockquote>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Code Snippets</div>
The code examples are indicative only.
They demonstrate basic concepts and approaches to using a feature.
Use them as inspiration and adapt these examples to best practice when developing applications for your platform.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="introduction"><a class="anchor" href="#introduction"></a>Introduction</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This content provides code and configuration examples covering the implementation of <a href="../../refer-glossary.html#peer-to-peer-sync" class="page">Peer-to-Peer Sync</a> over websockets.</p>
</div>
<div class="paragraph">
<p>Specifically it covers the implementation of a <a href="../../refer-glossary.html#passive-peer" class="page">Passive Peer</a>.
This <em>listener</em> will accept a connection from an <a href="../../refer-glossary.html#active-peer" class="page">Active Peer</a> and participate in the replication of database changes to bring both databases into sync.</p>
</div>
<div class="paragraph">
<p>In this context the <em>passive peer</em> (listener) acts as the <em>server</em> and the
 <em>active peer</em> (replicator) acts as the <em>client</em>.</p>
</div>
<div class="paragraph">
<p>You should initialize and configure a Listener for each Couchbase Lite database instance you want to to sync.
<a href="#simple-listener-initialization">Example 1</a> shows a simple initialization and configuration process.
Subsequent sections provide additional details and examples for the main configuration options.</p>
</div>
<div id="simple-listener-initialization" class="exampleblock">
<div class="title">Example 1. Listener configuration and initialization</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-swift hljs" data-lang="swift">fileprivate var _allowlistedUsers:[[String:String]] = []
fileprivate var _websocketListener:URLEndpointListener?
fileprivate var thisDB:Database?
  // Include websockets listener initializer code

  // func fMyPassListener() {
  let db=thisDB!
  let listenerConfig = URLEndpointListenerConfiguration(database: db) <i class="conum" data-value="1"></i><b>(1)</b>

  /* optionally */ let wsPort: UInt16 = 4984
  /* optionally */ let wssPort: UInt16 = 4985
  listenerConfig.port =  wssPort <i class="conum" data-value="2"></i><b>(2)</b>

  listenerConfig.networkInterface = "10.1.1.10"  <i class="conum" data-value="3"></i><b>(3)</b>

  listenerConfig.enableDeltaSync = true <i class="conum" data-value="4"></i><b>(4)</b>

  listenerConfig.disableTLS  = false <i class="conum" data-value="5"></i><b>(5)</b>

  // Use an anonymous self-signed cert
  listenerConfig.tlsIdentity = nil

  // Configure the client authenticator for Basic Authentication) <i class="conum" data-value="6"></i><b>(6)</b>
  listenerConfig.authenticator =
    ListenerPasswordAuthenticator(authenticator: {
      (thisUser, thisPassword) -&gt; Bool in
          if (self._allowlistedUsers.contains(
            ["password" : thisPassword, "name":thisUser])) {
              return true
          }
      return false
    })

  // Authenticate using Cert Authority
  // cert is a pre-populated object of type:SecCertificate representing a certificate
  let rootCertData = SecCertificateCopyData(cert) as Data
  let rootCert = SecCertificateCreateWithData(kCFAllocatorDefault, rootCertData as CFData)!
  // Listener:
  listenerConfig.authenticator = ListenerCertificateAuthenticator.init (rootCerts: [rootCert])

  // Initialize the listener
  _websocketListener = URLEndpointListener(config: listenerConfig) <i class="conum" data-value="7"></i><b>(7)</b>
  guard let websocketListener = _websocketListener else {
    throw print("WebsocketsListenerNotInitialized")
    // ... take appropriate actions
  }
  // Start the listener
  try websocketListener.start() <i class="conum" data-value="8"></i><b>(8)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Identify the local database to be used&#8201;&#8212;&#8201;see: <a href="#initialize-the-listener-configuration">Initialize the Listener Configuration</a></td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Optionally, choose a port to use.
By default the system will automatically assign a port&#8201;&#8212;&#8201;to over-ride this see: <a href="#set-network-and-port">Set Network and Port</a></td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Optionally, choose a network-interface to use. By default the system will listen on all network interfaces&#8201;&#8212;&#8201;to over-ride this see: <a href="#set-network-and-port">Set Network and Port</a></td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Optionally, choose to sync only changes, the default is not to enabld edelta-sync&#8201;&#8212;&#8201;see: <a href="#delta-sync">Delta Sync</a>.</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>Set server security.
TLS is always enabled out-of-the-box, so you can usually omit this line.
But you <em>can</em>, optionally, disable TLS (<strong>not</strong> advisable in production)&#8201;&#8212;&#8201;see: <a href="#tls-security">TLS Security</a></td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td>Optionally, apply the default TLS authentication, which is by anonymous self-signed certificate.</td>
</tr>
<tr>
<td><i class="conum" data-value="7"></i><b>7</b></td>
<td>Set client security.
Optionally, apply basic authentication to validate the user&#8217;s presented credentials (<code>thisUser</code> and <code>thisPassword</code>), where <code>username</code> and <code>password</code> are the valid credentials&#8201;&#8212;&#8201;see <a href="#client-authentication">Client Authentication</a> for more options.</td>
</tr>
<tr>
<td><i class="conum" data-value="8"></i><b>8</b></td>
<td>Initialize the listener using the configuration settings.</td>
</tr>
<tr>
<td><i class="conum" data-value="9"></i><b>9</b></td>
<td><a href="#start-listener">Start Listener</a></td>
</tr>
</table>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="api-references"><a class="anchor" href="#api-references"></a>API References</h2>
<div class="sectionbody">
<div class="paragraph">
<p>You can find <a href="https://ibsoln.github.io/stage/api/mobile/2.8.0/couchbase-lite-swift">Swift API References</a> here.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="device-discovery"><a class="anchor" href="#device-discovery"></a>Device Discovery</h2>
<div class="sectionbody">
<div class="paragraph">
<p><strong>This phase is optional:</strong> If the listener is initialized on a well known URL endpoint (for example, a static IP Address or well known DNS address) then you can configure active peers to connect to those.</p>
</div>
<div class="paragraph">
<p>Prior to initiating the listener you may execute a peer discovery phase.</p>
</div>
<div class="paragraph">
<p>For the passive peer, this involves advertising the service using, for example
<em>Bonjour</em> (see: <a href="https://developer.apple.com/bonjour/" class="bare">https://developer.apple.com/bonjour/</a>)
 and waiting for an invite from the active peer.</p>
</div>
<div class="paragraph">
<p>The connection is established once the passive peer has authenticated and accepted an active peer&#8217;s invitation.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="initialize-the-listener-configuration"><a class="anchor" href="#initialize-the-listener-configuration"></a>Initialize the Listener Configuration</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Initialize the Listener config with the local database.
All other configuration values will take their default setting.</p>
</div>
<div class="paragraph">
<p>Each Listener instance serves one Couchbase Lite database.
Couchbase sets no hard limit on the number of instances you can initialize.</p>
</div>
<div class="exampleblock">
<div class="title">Example 2. Specify Local Database</div>
<div class="content">
<div class="paragraph">
<p>In this example <code>thisDB</code> has previously been declared as an object of type Database.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-swift hljs" data-lang="swift">let db=thisDB!
let listenerConfig = URLEndpointListenerConfiguration(database: db) <i class="conum" data-value="1"></i><b>(1)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Set the local database name using the <a href="https://ibsoln.github.io/stage/api/mobile/2.8.0/couchbase-lite-swift/Classes/URLEndpointListenerConfiguration.html">URLEndpointListenerConfiguration</a>'s constructor <a href="https://ibsoln.github.io/stage/api/mobile/2.8.0/couchbase-lite-swift/Classes/URLEndpointListenerConfiguration.html#/s:18CouchbaseLiteSwift32URLEndpointListenerConfigurationC8databaseAcA8DatabaseC_tcfc">init(database:)</a>.</td>
</tr>
</table>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="set-network-and-port"><a class="anchor" href="#set-network-and-port"></a>Set Network and Port</h2>
<div class="sectionbody">
<div class="dlist">
<dl>
<dt class="hdlist1">Port number</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The Listener will automatically select an available port.</p>
</div>
<div class="exampleblock">
<div class="title">Example 3. Specify a Port to Use</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-swift hljs" data-lang="swift" data-source-url="https://github.com/ibsoln/docs-couchbase-lite/blob/undefined/modules/swift/examples/code-snippets/p2psync-websocket.swift">/* optionally */ let wsPort: UInt16 = 4984
/* optionally */ let wssPort: UInt16 = 4985
listenerConfig.port =  wssPort <i class="conum" data-value="1"></i><b>(1)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>To use a canonical port&#8201;&#8212;&#8201;one known to other applications - specify it explicitly using the <a href="https://ibsoln.github.io/stage/api/mobile/2.8.0/couchbase-lite-swift/Classes/URLEndpointListenerConfiguration.html#/s:18CouchbaseLiteSwift32URLEndpointListenerConfigurationC4ports6UInt16VSgvp">port</a> method shown here.</td>
</tr>
</table>
</div>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">Network Interface</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The Listener will listen on all network interfaces by default.</p>
</div>
<div class="exampleblock">
<div class="title">Example 4. Specify a Network Interface to Use</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-swift hljs" data-lang="swift" data-source-url="https://github.com/ibsoln/docs-couchbase-lite/blob/undefined/modules/swift/examples/code-snippets/p2psync-websocket.swift">listenerConfig.networkInterface = "10.1.1.10"  <i class="conum" data-value="1"></i><b>(1)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>To specify an interface&#8201;&#8212;&#8201;one known to other applications - identify it explicitly, using the <a href="https://ibsoln.github.io/stage/api/mobile/2.8.0/couchbase-lite-swift/Classes/URLEndpointListenerConfiguration.htmlC16networkInterfaceSSSgvp">networkInterface</a> method shown here.
This must be either an IP Address or network interface name such as <code>en0</code>.</td>
</tr>
</table>
</div>
</div>
</div>
</div>
</div>
</dd>
</dl>
</div>
</div>
</div>
<div class="sect1">
<h2 id="delta-sync"><a class="anchor" href="#delta-sync"></a>Delta Sync</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Delta Sync allows clients to sync only those parts of a document that have changed.
This can result in significant savings in bandwidth consumption as well as throughput improvements.
Both valuable benefits, especially when network bandwidth is constrained.</p>
</div>
<div class="exampleblock">
<div class="title">Example 5. Enable delta sync</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-swift hljs" data-lang="swift">listenerConfig.enableDeltaSync = true <i class="conum" data-value="1"></i><b>(1)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Delta sync replication is not enabled by default.
Use <a href="https://ibsoln.github.io/stage/api/mobile/2.8.0/couchbase-lite-swift/Classes/URLEndpointListenerConfiguration.html">URLEndpointListenerConfiguration</a>'s <a href="https://ibsoln.github.io/stage/api/mobile/2.8.0/couchbase-lite-swift/Classes/URLEndpointListenerConfiguration.html#/s:18CouchbaseLiteSwift32URLEndpointListenerConfigurationC15enableDeltaSyncSbvp">enableDeltaSync</a> method to activate or deactivate it.</td>
</tr>
</table>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="tls-security"><a class="anchor" href="#tls-security"></a>TLS Security</h2>
<div class="sectionbody">
<div class="paragraph">
<p>TLS based encryption is enabled by default and this setting ought to be used in any production environment. However, it <em>can</em> be disabled, for example for development and-or test environments.</p>
</div>
<div class="paragraph">
<p>The <code>disableTLS</code> setting is ignored when using <em>Basic Authentication</em>, but is must be 'false' when <em>Client Cert Authentication</em> is required.</p>
</div>
<div class="paragraph">
<p>When TLS is enabled, Couchbase Lite provides several options on how the Listener may be configured with an appropriate TLS Identity (<a href="#configure-tls-identity-for-listener">[configure-tls-identity-for-listener]</a>).</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Enable or Disable TLS</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>TLS is enabled by default.</p>
</div>
<div class="paragraph">
<p>Use <a href="https://ibsoln.github.io/stage/api/mobile/2.8.0/couchbase-lite-swift/Classes/URLEndpointListenerConfiguration.html">URLEndpointListenerConfiguration</a>'s <a href="https://ibsoln.github.io/stage/api/mobile/2.8.0/couchbase-lite-swift/Classes/URLEndpointListenerConfiguration.html#/s:18CouchbaseLiteSwift32URLEndpointListenerConfigurationC10disableTLSSbvp">disableTLS</a> method to disable TLS communication if necessary</p>
</div>
<div class="paragraph">
<p><a href="https://ibsoln.github.io/stage/api/mobile/2.8.0/couchbase-lite-swift/Classes/URLEndpointListenerConfiguration.html#/s:18CouchbaseLiteSwift32URLEndpointListenerConfigurationC10disableTLSSbvp">disableTLS</a> works in conjunction with <code>TLSIdentity</code>, to enable developers to define the key and-or certificate to be used.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If <code>disableTLS</code> is true&#8201;&#8212;&#8201;TLS communication is disabled and TLS identity is ignored.
Active peers will the <code>ws://</code> URL scheme used to connect to the listener.</p>
</li>
<li>
<p>If <code>disableTLS</code> is false or not specified&#8201;&#8212;&#8201;TLS communication is enabled.</p>
<div class="paragraph">
<p>Active peers will the <code>wss://</code> URL scheme used to connect to the listener.</p>
</div>
</li>
</ul>
</div>
</div>
</div>
</dd>
</dl>
</div>
<div id="configure-tls-identity-for-listener" class="dlist">
<dl>
<dt class="hdlist1">Configure TLS Identity for Listener</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Use <a href="https://ibsoln.github.io/stage/api/mobile/2.8.0/couchbase-lite-swift/Classes/URLEndpointListenerConfiguration.html">URLEndpointListenerConfiguration</a>'s
<a href="https://ibsoln.github.io/stage/api/mobile/2.8.0/couchbase-lite-swift/Classes/URLEndpointListenerConfiguration.html#/s:18CouchbaseLiteSwift32URLEndpointListenerConfigurationC11tlsIdentityAA11TLSIdentityCSgvp">tlsIdentity</a> method to configure the TLS Identity used in TLS communication.</p>
</div>
<div class="paragraph">
<p>If <code>TLSIdentity</code> is not set when TLS is enabled (default), the listener uses an auto-generated anonymous self-signed identity.
This doesn&#8217;t authenticate or verify trust (on the client side) but it does encrypt communication, giving a more secure option than Non-TLS communication.</p>
</div>
<div class="paragraph">
<p><strong>Reusable Id</strong>&#8201;&#8212;&#8201;If the platform supports secure storage, you can save and re-use the auto-generated identity. This avoids the need to generate new identities every time.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Typically, you will configure the Listener&#8217;s TLS Identity once during initial launch.
Subsequent starts of the Listener will then reuse the identity from secure storage, or (re)create it if it doesn&#8217;t exist
.
</td>
</tr>
</table>
</div>
</div>
</div>
</dd>
</dl>
</div>
<div class="exampleblock">
<div class="title">Example 6. Set Listener&#8217;s TLS identity</div>
<div class="content">
<div class="tabset is-loading">
<div class="ulist tabs">
<ul>
<li>
<p><a id="tabset1_import-from-key-pair"></a>Import from key-pair</p>
</li>
<li>
<p><a id="tabset1_create-self-signed-cert"></a>Create Self-Signed Cert</p>
</li>
<li>
<p><a id="tabset1_use-anonymous-self-signed-certificate"></a>Use Anonymous Self-Signed Certificate</p>
</li>
</ul>
</div>
<div class="content">
<div class="tab-pane" aria-labelledby="tabset1_import-from-key-pair">
<div class="paragraph">
<p>Import a key pair into secure storage and create a TLSIdentity from the imported key-pair.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-swift hljs" data-lang="swift">listenerConfig.disableTLS  = false <i class="conum" data-value="1"></i><b>(1)</b>

// set the TLS Identity
listenerConfig.tlsIdentity =
  TLSIdentity(withLabel:thisIdentity)</code></pre>
</div>
</div>
</div>
<div class="tab-pane" aria-labelledby="tabset1_create-self-signed-cert">
<div class="paragraph">
<p>Create a TLSIdentity for the server using convenience API. System generates self-signed cert.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-swift hljs" data-lang="swift">listenerConfig.disableTLS  = false <i class="conum" data-value="1"></i><b>(1)</b>

// set the TLS Identity
listenerConfig.tlsIdentity =
  TLSIdentity(withLabel:thisIdentity)</code></pre>
</div>
</div>
</div>
<div class="tab-pane" aria-labelledby="tabset1_use-anonymous-self-signed-certificate">
<div class="paragraph">
<p>This examples uses an anonymous certificate.
These are self signed certificates generated by Couchbase Lite. The generated certificates are securely stored in keystore.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-swift hljs" data-lang="swift">listenerConfig.disableTLS  = false <i class="conum" data-value="1"></i><b>(1)</b>

// Use an anonymous self-signed cert
listenerConfig.tlsIdentity = nil</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>These are are the default settings; authentication using an anonymous self-signed certificate is assumed.</td>
</tr>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="client-authentication"><a class="anchor" href="#client-authentication"></a>Client Authentication</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In this section: <a href="#authenticate-using-the-client-username-and-password">Authenticate Using the Client Username and Password</a>  |  <a href="#authenticate-using-the-client-certificate">Authenticate using the Client Certificate</a>  |  <a href="#delete-tls-identity">Delete TLS Identity</a>  |  <a href="#the-impact-of-tls-settings">The Impact of TLS Settings</a></p>
</div>
<div class="paragraph">
<p>Use the
<a href="https://ibsoln.github.io/stage/api/mobile/2.8.0/couchbase-lite-swift/Classes/URLEndpointListenerConfiguration.html">URLEndpointListenerConfiguration</a> class&#8217;s <a href="https://ibsoln.github.io/stage/api/mobile/2.8.0/couchbase-lite-swift/Classes/URLEndpointListenerConfiguration.html#/s:18CouchbaseLiteSwift32URLEndpointListenerConfigurationC13authenticatorAA0E13Authenticator_pSgvp">authenticator</a> method to specify how client credentials are to be authenticated.</p>
</div>
<div class="paragraph">
<p>Valid options are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>{url-api-class-ListenerPasswordAuthenticator}&#8201;&#8212;&#8201;which authenticates using a client&#8217;s username and password</p>
</li>
<li>
<p>{url-api-class-ListenerCertificateAuthenticator}&#8201;&#8212;&#8201;which authenticates using  a clients certificate.</p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="authenticate-using-the-client-username-and-password"><a class="anchor" href="#authenticate-using-the-client-username-and-password"></a>Authenticate Using the Client Username and Password</h3>
<div class="paragraph">
<p>This section shows how to authenticate client username and password using basic authentication.
For how to authenticate using client certificates see: <a href="#authenticate-using-the-client-certificate">Authenticate using the Client Certificate</a></p>
</div>
<div class="paragraph">
<p>Use the {url-api-class-ListenerPasswordAuthenticator} class to provide password type authentication such as the Basic Authentication.
The actual authentication is provided by the application code. Often in the form of a closure where the platform permits.</p>
</div>
<div class="exampleblock">
<div class="title">Example 7. Password authentication</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-swift hljs" data-lang="swift">// Configure the client authenticator for Basic Authentication) <i class="conum" data-value="1"></i><b>(1)</b>
listenerConfig.authenticator =
  ListenerPasswordAuthenticator(authenticator: {
    (thisUser, thisPassword) -&gt; Bool in
        if (self._allowlistedUsers.contains(
          ["password" : thisPassword, "name":thisUser])) {
            return true
        }
    return false
  })</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Where 'thisUser' and 'thisPassword' are the previously populated values to be authenticated.</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="authenticate-using-the-client-certificate"><a class="anchor" href="#authenticate-using-the-client-certificate"></a>Authenticate using the Client Certificate</h3>
<div class="ulist">
<ul>
<li>
<p>Root CA certificate chains<br></p>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Any client certificate signed by the given root CA certificate chains is authenticated.</p>
</div>
<div class="paragraph">
<p>Initialize the <code>ListenerCertificateAuthenticator</code> using the <code>rootCert</code> interface. This identifies the Root CA Chain to be used to verify a certificate chain received from the client.</p>
</div>
</div>
</div>
</li>
<li>
<p>Application logic</p>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>This option is used for authenticating self-signed certificates.</p>
</div>
<div class="paragraph">
<p>Use the <code>ListenerCertificateAuthenticator</code> to provide the application logic to verify a certificate chain received from the client.
The logic should take the form of function or block (such as, a closure expression) where the platform allows.</p>
</div>
</div>
</div>
</li>
</ul>
</div>
<div class="exampleblock">
<div class="title">Example 8. Set Certificate Authorization</div>
<div class="content">
<div class="tabset is-loading">
<div class="ulist tabs">
<ul>
<li>
<p><a id="tabset2_root-ca"></a>Root CA</p>
</li>
<li>
<p><a id="tabset2_application-logic"></a>Application Logic</p>
</li>
</ul>
</div>
<div class="content">
<div class="tab-pane" aria-labelledby="tabset2_root-ca">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-swift hljs" data-lang="swift"></code></pre>
</div>
</div>
</div>
<div class="tab-pane" aria-labelledby="tabset2_application-logic">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-swift hljs" data-lang="swift">// Authenticate self-signed cert using application logic
listenerConfig.authenticator = ListenerCertificateAuthenticator.init {
  (cert) -&gt; Bool in
    var cert:SecCertificate
    var certCommonName:CFString?
    let status=SecCertificateCopyCommonName(cert, &amp;certCommonName)
    if (self._allowlistedUsers.contains(["name": certCommonName! as String])) {
        return true
    }
    return false
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="delete-tls-identity"><a class="anchor" href="#delete-tls-identity"></a>Delete TLS Identity</h3>
<div class="paragraph">
<p>You can remove unwanted TLS identities from Keychain using the convenience API.</p>
</div>
<div class="exampleblock">
<div class="title">Example 9. Deleting TLS Identities</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-swift hljs" data-lang="swift">try TLSIdentity.deleteIdentity(withLabel: serverCertLabel);</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="the-impact-of-tls-settings"><a class="anchor" href="#the-impact-of-tls-settings"></a>The Impact of TLS Settings</h3>
<div class="paragraph">
<p>The table in this section shows the expected system behavior (in regards to security ) depending on the TLS configuration settings deployed.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 1. Expected system behavior</caption>
<colgroup>
<col style="width: 12%;">
<col style="width: 44%;">
<col style="width: 44%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">disableTLS</th>
<th class="tableblock halign-left valign-top">tlsIdentity (corresponding to server)</th>
<th class="tableblock halign-left valign-top">Expected system behavior</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Ignored</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>TLS is disabled; all communication is plain text.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">set to <code>nil</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="ulist">
<ul>
<li>
<p>The system will auto generate an <em>anonymous</em> self signed cert.</p>
</li>
<li>
<p>Active peers will skip validation of the server cert.</p>
</li>
<li>
<p>Communication is encrypted</p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Set to server identity generated from a self- or CA-signed certificate</p>
</div>
<div class="ulist">
<ul>
<li>
<p>On first use&#8201;&#8212;&#8201;Bring your own certificate and private key; for example, using the <a href="https://ibsoln.github.io/stage/api/mobile/2.8.0/couchbase-lite-swift/Classes/TLSIdentity.html">TLSIdentity</a> class&#8217;s {url-api-method-tls-identity-create} method to add it to the Keychain.</p>
</li>
<li>
<p>Each time&#8201;&#8212;&#8201;Use the server identity from the certificate stored in the Keychain; for example, using the <a href="https://ibsoln.github.io/stage/api/mobile/2.8.0/couchbase-lite-swift/Classes/TLSIdentity.html">TLSIdentity</a> class&#8217;s {url-api-method-tls-identity-get} method with the alias you want to retrieve..</p>
</li>
</ul>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="ulist">
<ul>
<li>
<p>System will use the configured identity.</p>
</li>
<li>
<p>Active peers will validate the server certificate corresponding to the TLSIdentity (as long as they are configured to not skip validation&#8201;&#8212;&#8201;see <a href="#tls-security">TLS Security</a>).</p>
</li>
</ul>
</div></div></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="start-listener"><a class="anchor" href="#start-listener"></a>Start Listener</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Once you have completed the Listener&#8217;s configuration settings you can initialize the Listener instance and start it running&#8201;&#8212;&#8201;see: <a href="#initialize-and-start-listener">Example 10</a></p>
</div>
<div id="initialize-and-start-listener" class="exampleblock">
<div class="title">Example 10. Initialize and start listener</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-swift hljs" data-lang="swift">// Initialize the listener
_websocketListener = URLEndpointListener(config: listenerConfig) <i class="conum" data-value="1"></i><b>(1)</b>
guard let websocketListener = _websocketListener else {
  throw print("WebsocketsListenerNotInitialized")
  // ... take appropriate actions
}
// Start the listener
try websocketListener.start() <i class="conum" data-value="2"></i><b>(2)</b></code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="monitor-listener"><a class="anchor" href="#monitor-listener"></a>Monitor Listener</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Use the Listener&#8217;s <code>getStatus</code> method to get counts of total and active connections&#8201;&#8212;&#8201;see: <a href="#get-connection-counts">Example 11</a>.</p>
</div>
<div id="get-connection-counts" class="exampleblock">
<div class="title">Example 11. Get connection counts</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-swift hljs" data-lang="swift" data-source-url="https://github.com/ibsoln/docs-couchbase-lite/blob/undefined/modules/swift/examples/code-snippets/p2psync-websocket.swift">let totalConnections = websocketListener.status.connectionCount
let activeConnections = websocketListener.status.activeConnectionCount</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="stop-listener"><a class="anchor" href="#stop-listener"></a>Stop Listener</h2>
<div class="sectionbody">
<div class="exampleblock">
<div class="content">
<div class="listingblock">
<div class="title">Stop listener using <code>stop</code> method</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-swift hljs" data-lang="swift" data-source-url="https://github.com/ibsoln/docs-couchbase-lite/blob/undefined/modules/swift/examples/code-snippets/p2psync-websocket.swift">listener.stop()</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Closing the database will also close the listener.
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="related-content"><a class="anchor" href="#related-content"></a>Related Content</h2>
<div class="sectionbody">
<div class="card-row three-column-row">
<div class="sect5 column">
<h6 id=""><a class="anchor" href="#"></a></h6>
<div class="ulist">
<div class="title">How to</div>
<ul>
<li>
<p><a href="swift-p2psync-websocket-using-passive.html" class="page">Passive Peer</a></p>
</li>
<li>
<p><a href="swift-p2psync-websocket-using-active.html" class="page">Active Peer</a></p>
</li>
</ul>
</div>
</div>
<div class="sect5 column">
<h6 id="-2"><a class="anchor" href="#-2"></a></h6>
<div class="ulist">
<div class="title">Concepts</div>
<ul>
<li>
<p><a href="../learn/swift-p2psync.html" class="page">Peer-to-peer Synchronization</a></p>
</li>
<li>
<p><a href="https://ibsoln.github.io/stage/api/mobile/2.8.0/couchbase-lite-swift">API References</a>
.</p>
</li>
</ul>
</div>
</div>
<div class="sect5 column">
<h6 id="-3"><a class="anchor" href="#-3"></a></h6>
<div class="ulist">
<div class="title">Community Resources ...</div>
<ul>
<li>
<p><a href="https://forums.couchbase.com/c/mobile/14">Forum</a>  <strong>|</strong>  <a href="https://blog.couchbase.com/">Blog</a>   <strong>|</strong>  <a href="https://docs.couchbase.com/tutorials/index.html">Tutorials</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="related-content-2"><a class="anchor" href="#related-content-2"></a>Related Content</h2>
<div class="sectionbody">
<div class="card-row three-column-row">
<div class="sect5 column">
<h6 id="-4"><a class="anchor" href="#-4"></a></h6>
<div class="ulist">
<div class="title">How to</div>
<ul>
<li>
<p><a href="swift-p2psync-websocket-using-passive.html" class="page">Passive Peer</a></p>
</li>
<li>
<p><a href="swift-p2psync-websocket-using-active.html" class="page">Active Peer</a></p>
</li>
</ul>
</div>
</div>
<div class="sect5 column">
<h6 id="-5"><a class="anchor" href="#-5"></a></h6>
<div class="ulist">
<div class="title">Concepts</div>
<ul>
<li>
<p><a href="../learn/swift-p2psync.html" class="page">Peer-to-peer Synchronization</a></p>
</li>
<li>
<p><a href="https://ibsoln.github.io/stage/api/mobile/2.8.0/couchbase-lite-swift">API References</a>
.</p>
</li>
</ul>
</div>
</div>
<div class="sect5 column">
<h6 id="-6"><a class="anchor" href="#-6"></a></h6>
<div class="ulist">
<div class="title">Community Resources ...</div>
<ul>
<li>
<p><a href="https://forums.couchbase.com/c/mobile/14">Forum</a>  <strong>|</strong>  <a href="https://blog.couchbase.com/">Blog</a>   <strong>|</strong>  <a href="https://docs.couchbase.com/tutorials/index.html">Tutorials</a></p>
</li>
</ul>
</div>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="title">Enterprise Edition only</div>
This an <a href="https://www.couchbase.com/products/editions">Enterprise Edition</a> feature.
Purchase the <em>Enterprise License</em>, which includes official <a href="https://www.couchbase.com/support-policy">Couchbase Support</a>, to use it in production (see the license and support <a href="https://www.couchbase.com/licensing-and-support-faq">Licensing</a>).
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
</article>
</main>
</div>
<footer class="footer">
  <div class="container">
    <div class="footer-links">
      <div class="col">
        <div class="footer-logo">
          <a href="https://www.couchbase.com" class="icon">
            <img src="../../../../_/img/couchbase_logo_black.svg" alt="Couchbase">
          </a>
        </div>
      </div>
      <div class="col">
        <ul>
          <li><a href="https://docs.couchbase.com" target="_blank" rel="noopener">Documentation</a></li>
          <li><a href="https://forums.couchbase.com" target="_blank" rel="noopener">Forums</a></li>
          <li><a href="https://support.couchbase.com" target="_blank" rel="noopener">Support</a></li>
        </ul>
      </div>
      <div class="col">
        <ul>
          <li><a href="https://developer.couchbase.com" target="_blank" rel="noopener">Developer Portal</a></li>
          <li><a href="https://blog.couchbase.com" target="_blank" rel="noopener">Blog</a></li>
          <li><a href="https://www.couchbase.com/resources">Resources</a></li>
        </ul>
      </div>
      <div class="col">
        <ul>
          <li><a href="https://www.couchbase.com/get-started-developing-nosql">Get Started</a></li>
          <li><a href="https://www.couchbase.com/downloads">Downloads</a></li>
          <li><a href="https://learn.couchbase.com/store?utf8=%E2%9C%93&ss=1&ct=78327&commit=Filter" target="_blank" rel="noopener">Training</a></li>
        </ul>
      </div>
      <div class="col">
        <ul class="social-icons">
          <li>
            <svg  width="14" height="14" viewBox="0 0 32 32"> <path id="facebook" class="cls-1" d="M29,0H3A2.652,2.652,0,0,0,0,3V29a2.652,2.652,0,0,0,3,3H16V18H12V14h4V12a6.452,6.452,0,0,1,6-6h4v4H22a2.151,2.151,0,0,0-2,2v2h6l-1,4H20V32h9a2.652,2.652,0,0,0,3-3V3A2.652,2.652,0,0,0,29,0Z"/></svg>
            <a href="https://www.facebook.com/Couchbase" class="icon">
            Facebook
            </a>
          </li>
          <li>
            <svg  width="14" height="14" viewBox="0 0 32.1 26.1"> <path id="twitter" class="cls-1" d="M32,7.1a11.836,11.836,0,0,1-3.8,1,6.462,6.462,0,0,0,2.9-3.6,12.606,12.606,0,0,1-4.2,1.6A6.492,6.492,0,0,0,22.1,4a6.594,6.594,0,0,0-6.6,6.6,7.719,7.719,0,0,0,.2,1.5A18.458,18.458,0,0,1,2.2,5.2a6.294,6.294,0,0,0-.9,3.3A6.765,6.765,0,0,0,4.2,14a6.109,6.109,0,0,1-3-.8v.1a6.543,6.543,0,0,0,5.3,6.4,4.678,4.678,0,0,1-1.7.2,4.869,4.869,0,0,1-1.2-.1,6.679,6.679,0,0,0,6.1,4.6,12.917,12.917,0,0,1-8.2,2.8,9.151,9.151,0,0,1-1.6-.1,18.438,18.438,0,0,0,10.1,3c12.1,0,18.7-10,18.7-18.7v-.8A13.336,13.336,0,0,0,32,7.2Z" transform="translate(0.1 -4)"/></svg>
            <a href="https://twitter.com/couchbase" class="icon">
              Twitter
            </a>
          </li>
          <li>
          <svg  width="14" height="14" viewBox="0 0 32 32"> <path id="linkedin" class="cls-1" d="M29,0H3A3.076,3.076,0,0,0,0,3V29a3.009,3.009,0,0,0,3,3H29a2.946,2.946,0,0,0,3-3V3A3.009,3.009,0,0,0,29,0ZM12,26H8V12h4ZM10,10a2,2,0,1,1,2-2A2.006,2.006,0,0,1,10,10ZM26,26H22V18a2,2,0,0,0-4,0v8H14V12h4v2.5c.8-1.1,2.1-2.5,3.5-2.5A4.736,4.736,0,0,1,26,17Z"/></svg>
              <a href="https://www.linkedin.com/company/couchbase" class="icon">
             Linkedin
            </a>
          </li>
        </ul>
      </div>
    </div>
    <div class="footer-terms">
      <div class="footer-terms-copyright">
          <span> 2020 Couchbase, Inc. Couchbase, Couchbase Lite and the Couchbase logo are registered trademarks of Couchbase, Inc.</span>
      </div>
      <div class="footer-terms-links">
        <a href="https://www.couchbase.com/terms-of-use">Terms of Use</a>
        <a href="https://www.couchbase.com/privacy-policy">Privacy Policy</a>
        <a href="https://www.couchbase.com/cookie-policy">Cookie Policy</a>
        <a href="https://www.couchbase.com/support-policy">Support Policy</a>
        <a href="https://info.couchbase.com/unsubscribe-or-manage-preferences.html" target="_blank" rel="noopener">Marketing Preference Center</a>
      </div>
    </div>
  </div>
</footer>
<script src="../../../../_/js/site.js"></script>
<script async src="../../../../_/js/vendor/fontawesome-icon-defs.js"></script>
<script async src="../../../../_/js/vendor/fontawesome.js"></script>
<script async src="../../../../_/js/vendor/highlight.js"></script>
</body>
</html>
