<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>Initialize Inter-Sync Gateway Replications | Couchbase Docs Preview Site</title>
<link rel="canonical" href="https://ibsoln.github.io/sync-gateway/2.8/learn/icr-running.html">
<link rel="stylesheet" href="../../../_/css/site.css">
<script src="../../../_/js/vendor/jquery.js"></script>
<meta name="description" content="Initializing and running inter-Sync Gateway replication">
<link rel="schema.dcterms" href="https://purl.org/dc/terms/">
<meta name="dcterms.subject" content="sync-gateway">
<meta name="dcterms.identifier" content="2.8">
<meta name="generator" content="Antora 2.3.3">
<link rel="icon" href="../../../_/img/favicon.ico" type="image/x-icon">
</head>
<body class="article">
<header class="header fixed-top">
  <div class="header-top-row">
      <div class="container">
          <nav class="navbar navbar-expand-md flex-nowrap justify-content-between navbar-new-top">

              <a class="navbar-brand" href="https://www.couchbase.com">
                <img src="../../../_/img/couchbase-documentation-logo.svg" alt="Couchbase" />
              </a>
              <button class="navbar-burger" data-target="topbar-menu">
                <span></span>
                <span></span>
                <span></span>
              </button>

          </nav>
      </div>
  </div>
  <div class="header-bottom-row" id="topbar-menu">
    <div class="container">
        <nav  class="navbar navbar-new-bottom">

              <div class="navbar-collapse collapse" id="navbar2">
                <ul class="navbar-nav w-100 justify-content-start">
                  <li class="nav-item">
                    <a href="https://ibsoln.github.io/home/index.html" class="nav-link">
                      <i class="fas fa-home"></i>
                    </a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="../../../home/server.html">
                      Server
                    </a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="../../../home/mobile.html">
                      Mobile
                    </a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="../../../home/cloud.html">
                      Cloud
                    </a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="../../../home/sdk.html">
                      SDKs
                    </a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="../../../tutorials/index.html">
                      Tutorials
                      <span class="arrow">
                        <i class="fas fa-arrow-right"></i>
                      </span>
                    </a>
                  </li>
                </ul>
              </div>
              <div class="primary-action">
                <form class="navbar-item search">
                  <input type="text" placeholder="Search Docs" class="query" id="search-query" />
                  <button type="button" class="search-btn">
                    <i class="fas fa-search"></i>
                  </button>
                </form>
                <a class="btn btn-primary try-btn" href="https://www.couchbase.com/downloads">
                  Downloads
                </a>
              </div>

        </nav>
    </div>
   </div>
</header>
<div class="body container">
<nav class="nav">
<div class="left-sidebar-menu">
<div class="version-control-box">
<div class="component-frame">
<div class="frame-icon">
<img src="../../../_/img/server-icon.png" alt="">
</div>
<div class="frame-body">
<h4 class="title"><span class="">Sync Gateway</span></h4>
<a class="frame-link component" href="../index.html"> <span class="version">2.8</span></a>
</div>
</div>
</div>
<div class="nav-menu">
<ul class="nav-list">
<li class="nav-item is-current-path is-active is-active-depth-2  " data-depth="0">

<span class="nav-line "  data-depth="0">
<span class="in-toggle" data-depth="0"></span>
<a class="nav-link" href="../index.html">Sync Gateway</a>
</span>
<ul class="nav-list">
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<a class="nav-link" href="../sgw-whatsnew.html">What&#8217;s New</a>
</span>
</li>
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<span class="in-toggle" data-depth="1"></span>
<a class="nav-link" href="../introduction.html">Start Here!</a>
</span>
<ul class="nav-list">
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../start/gs-sgw-prereqs.html">Prepare</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../start/gs-sgw-install.html">Install</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../start/gs-sgw-config.html">Verify</a>
</span>
</li>
</ul>
</li>
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<a class="nav-link" href="../data-modeling.html">Data Modelling</a>
</span>
</li>
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<span class="in-toggle" data-depth="1"></span>
<span class="nav-text ">Concepts</span>
</span>
<ul class="nav-list">
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="users-and-roles.html">Users</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="roles.html">Roles</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="sync-gateway-channels.html">Channels</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="concept-fundamentals-data-tombstones.html">Tombstones</a>
</span>
</li>
</ul>
</li>
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<a class="nav-link" href="../refer/config-properties.html">Configuration File</a>
</span>
</li>
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<span class="in-toggle" data-depth="1"></span>
<a class="nav-link" href="../start/gs-sgw-api-access.html">REST API Access</a>
</span>
<ul class="nav-list">
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../refer/rest-api-public.html">Public REST API</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../refer/rest-api-admin.html">Admin REST API</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../refer/rest-api-metrics.html">Metrics REST API</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../advance/adv-rest-api-client.html">REST API Client</a>
</span>
</li>
</ul>
</li>
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<span class="in-toggle" data-depth="1"></span>
<span class="nav-text ">Security</span>
</span>
<ul class="nav-list">
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="authentication.html">User Authentication</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../security.html">TLS Certificate Authentication</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<span class="in-toggle" data-depth="2"></span>
<span class="nav-text ">Access Control</span>
</span>
<ul class="nav-list">
<li class="nav-item " data-depth="3">

<span class="nav-line "  data-depth="3">
<a class="nav-link" href="defining-sync-functions.html">Sync Function</a>
</span>
</li>
<li class="nav-item " data-depth="3">

<span class="nav-line "  data-depth="3">
<a class="nav-link" href="../advance/adv-sgw-cfg-import-filter.html">Import filter</a>
</span>
</li>
<li class="nav-item " data-depth="3">

<span class="nav-line "  data-depth="3">
<a class="nav-link" href="read-access.html">Read Access</a>
</span>
</li>
<li class="nav-item " data-depth="3">

<span class="nav-line "  data-depth="3">
<a class="nav-link" href="write-access.html">Write Access</a>
</span>
</li>
</ul>
</li>
</ul>
</li>
<li class="nav-item is-current-path is-active is-active-depth-2  " data-depth="1">

<span class="nav-line "  data-depth="1">
<span class="in-toggle" data-depth="1"></span>
<span class="nav-text ">Sync</span>
</span>
<ul class="nav-list">
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../shared-bucket-access.html">Sync with Couchbase Server</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../sync-from-client.html">Sync with Couchbase Lite</a>
</span>
</li>
<li class="nav-item is-current-path is-active is-active-depth-2  " data-depth="2">

<span class="nav-line "  data-depth="2">
<span class="in-toggle" data-depth="2"></span>
<a class="nav-link" href="icr-sgreplicate.html">Inter-Sync Gateway Replication</a>
</span>
<ul class="nav-list">
<li class="nav-item is-current-page is-active is-active-depth-2  " data-depth="3">

<span class="nav-line "  data-depth="3">
<a class="nav-link" href="icr-running.html">Initialize</a>
</span>
</li>
<li class="nav-item " data-depth="3">

<span class="nav-line "  data-depth="3">
<a class="nav-link" href="icr-admin.html">Manage</a>
</span>
</li>
<li class="nav-item " data-depth="3">

<span class="nav-line "  data-depth="3">
<a class="nav-link" href="icr-monitoring.html">Monitor</a>
</span>
</li>
</ul>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../managing-tombstones.html">Managing Tombstones</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../delta-sync.html">Delta Sync</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../resync.html">Resync</a>
</span>
</li>
</ul>
</li>
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<span class="in-toggle" data-depth="1"></span>
<span class="nav-text ">Manage</span>
</span>
<ul class="nav-list">
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../stats-monitoring.html">Monitor</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<span class="in-toggle" data-depth="2"></span>
<span class="nav-text ">Logging and Troubleshooting</span>
</span>
<ul class="nav-list">
<li class="nav-item " data-depth="3">

<span class="nav-line "  data-depth="3">
<a class="nav-link" href="../advance/logging.html">Logging</a>
</span>
</li>
<li class="nav-item " data-depth="3">

<span class="nav-line "  data-depth="3">
<a class="nav-link" href="../sgcollect-info.html">SG Collect</a>
</span>
</li>
</ul>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../database-offline.html">Take Database Offline/Online</a>
</span>
</li>
</ul>
</li>
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<span class="in-toggle" data-depth="1"></span>
<span class="nav-text ">Integrate</span>
</span>
<ul class="nav-list">
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../events.html">Webhooks</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../server-integration.html">Changes Feed</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../integrating-external-stores.html">External Stores</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../stats-prometheus.html">Prometheus Feed</a>
</span>
</li>
</ul>
</li>
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<span class="in-toggle" data-depth="1"></span>
<a class="nav-link" href="../deployment.html">Deploy</a>
</span>
<ul class="nav-list">
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../command-line-options.html">Using Command Line</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../load-balancer.html">Load Balancer</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../os-level-tuning.html">OS-level Tuning</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../indexing.html">Indexing versus Views</a>
</span>
</li>
</ul>
</li>
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<a class="nav-link" href="../advance/deploy/upgrade.html">Upgrade</a>
</span>
</li>
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<span class="in-toggle" data-depth="1"></span>
<span class="nav-text ">Use Kubernetes</span>
</span>
<ul class="nav-list">
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../advance/kubernetes/deploy-cluster.html">Deploy</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="#operator::tutorial-sync-gateway-manage.adoc">Manage a Sync Gateway Cluster</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="#operator::tutorial-sync-gateway-clients.adoc">Expose Sync Gateway to Couchbase Lite clients</a>
</span>
</li>
</ul>
</li>
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<span class="in-toggle" data-depth="1"></span>
<span class="nav-text ">Product Notes</span>
</span>
<ul class="nav-list">
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../prodnotes/pn-release-notes.html">Release Notes</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../prodnotes/pn-supported-os.html">Supported OS</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../prodnotes/pn-compatibility.html">Compatibility Matrix</a>
</span>
</li>
</ul>
</li>
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<span class="in-toggle" data-depth="1"></span>
<span class="nav-text ">Legacy Features</span>
</span>
<ul class="nav-list">
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../resolving-conflicts.html">Conflict Resolution 1.x Clients</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="icr-sgreplicate-sgr1.html">Inter-Sync Gateway Replication pre-2.8</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="logging-legacy-pre2-1.html">Log Rotation pre-2.1</a>
</span>
</li>
</ul>
</li>
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<a class="nav-link" href="../refer/refer-sgw-glossary.html">Sync Gateway Glossary</a>
</span>
</li>
</ul>
</li>
<li class="nav-item " data-depth="0">

<span class="nav-line "  data-depth="0">
<span class="in-toggle" data-depth="0"></span>
<a class="nav-link" href="../../../couchbase-lite/2.8/introduction.html">Couchbase Lite</a>
</span>
<ul class="nav-list">
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<a class="nav-link" href="../../../couchbase-lite/2.8/android/quickstart.html">Android (Java)</a>
</span>
</li>
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<a class="nav-link" href="../../../couchbase-lite/2.8/csharp/quickstart.html">C#</a>
</span>
</li>
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<a class="nav-link" href="../../../couchbase-lite/2.8/java/quickstart.html">Java</a>
</span>
</li>
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<a class="nav-link" href="../../../couchbase-lite/2.8/objc/quickstart.html">Objective-C</a>
</span>
</li>
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<a class="nav-link" href="../../../couchbase-lite/2.8/swift/quickstart.html">Swift</a>
</span>
</li>
</ul>
</li>
</ul>
</div>
<a href="#" class="menu-expand-toggle"> <span>Navigation</span> <i class="fas fa-times-circle"></i> <i class="fas fa-chevron-circle-left"></i></a>
</div></nav>
<aside class="toc sidebar">
  <div class="sidebar-box">
    <div class="tools" role="navigation">
<ul>
<li class="tool edit"><a href="file:///Users/ianbridge/CouchbaseDocs/bau/sgw/modules/ROOT/pages/learn/icr-running.adoc" title="Edit Page" target="_blank" rel="noopener">Edit on GitHub</a></li>
</ul>
</div>
    <div class="toc-menu"></div>
    <div class="is-this-helpful-box">
      <h4> Is this page helpful?</h4>
      <div class="btn-row">
        <a href="#" class="like-btn helpful-btn" id="yesBtn" data-page-rating="like" >
                <i class="far fa-thumbs-up"></i>
            Yes

            </a>
        <a href="#" class="dislike-btn helpful-btn" id="noBtn"  data-page-rating="dislike"> <i class="far fa-thumbs-down"></i> No</a>
      </div>
      <div class="any-feedback">
        <a href="#" class="btn any-feedback-btn" id="myCustomTrigger">Leave Additional Feedback? </a>
      </div>
      <div class="dialog-box" id="dialogBox">
        <form>
            <div class="form-group " id="additionalFeedbackBox">
              <textarea class="input-control feed-back-msg" rows="8" placeholder="Any Additonal Feedback?"></textarea>

              <div class="action-btn-row ">
                <a href="#" class="skip-btn" id="skipBtnMsg">Skip</a>
                  <button class="submit-btn btn blue-btn disabled" > Submit  </button>
                  <a href="#" class="info-btn"><i class="fas fa-info-circle"></i></a>
              </div>


            </div>

        </form>

      </div>
    </div>
  </div>

</aside>

<div class="feedback-modal modal-popup">
  <div class="modal-popup-dialogue">
    <div class="popup-header">
      <a href="#" class="close-popup"><i class="fa fa-times"></i></a>
    </div>
    <div class="popup-content">
      <p>
        Please use the form below to provide your feedback. Because your feedback is valuable to us,
         the information you submit in this form is recorded in our issue tracking system (JIRA), which is publicly available.
        You can track the status of your feedback using the ticket number displayed in the dialog once you submit the form.
      </p>
    </div>
  </div>
</div>

<main class="article" data-ceiling="topbar">
<div class="article-header">
<nav class="crumbs" aria-label="breadcrumbs">
<ul>
<li class="crumb"><a href="../index.html">Sync Gateway</a></li>
<li class="crumb">Sync</li>
<li class="crumb"><a href="icr-sgreplicate.html">Inter-Sync Gateway Replication</a></li>
<li class="crumb"><a href="icr-running.html">Initialize</a></li>
</ul>
</nav>
</div>
<article class="doc">
<div class="page-heading-title">
<h1 class="page">Initialize Inter-Sync Gateway Replications</h1>
</div>
<div class="contributor-list-box">
<span class="last-commit-date" id="commitdate">    </span>
<ul id="contributorList"></ul>
<span  id="otherContributor"> + </span>
</div><div id="preamble">
<div class="sectionbody">
<div class="quoteblock abstract">
<blockquote>
<div class="paragraph">
<p>Description&#8201;&#8212;&#8201;<em>Initializing and running inter-Sync Gateway replication</em><br>
<em>Abstract&#8201;&#8212;&#8201;This content explains how to configure, initialize and run replications between Sync Gateway clusters.</em><br>
Related Content&#8201;&#8212;&#8201;<a href="../refer/config-properties.html" class="page">Configuration File</a> | <a href="../refer/rest-api-admin.html" class="page">Admin REST API</a> | <a href="icr-sgreplicate.html" class="page">Inter-Sync Gateway Replication</a></p>
</div>
</blockquote>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
<div class="title">Context Clarification</div>
<div class="paragraph">
<p>This content relates only to inter-Sync Gateway replication in Sync Gateway 2.8+.
For documentation on pre-2.8 inter-Sync Gateway replication (also known as SG Replicate)&#8201;&#8212;&#8201;see <a href="icr-sgreplicate-sgr1.html" class="page">Inter-Sync Gateway Replication pre-2.8</a></p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="introduction"><a class="anchor" href="#introduction"></a>Introduction</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Replications are initialized by submitting a <a href="../refer/refer-sgw-glossary.html#replication-definition" class="page">replication definition<span class="image"><img src="../_images/icons/glossaryIconImage2.png" alt="glossary icon" width="14"></span></a> using either:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A 'JSON' configuration file (<code>sync-gateway-config.json</code>)</p>
</li>
<li>
<p>The Admin REST API, using a utility such as <code>curl</code>, or an application such as <em>Postman</em>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Wherever they are defined, the elements of a replication definition are the same, with the exception of these Admin REST API only elements:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>adhoc</code>&#8201;&#8212;&#8201;Use this to specify that the replication is ad hoc <sup class="footnote" id="_footnote_fn-restonly">[<a id="_footnoteref_1" class="footnote" href="#_footnotedef_1" title="View footnote.">1</a>]</sup>.</p>
</li>
<li>
<p><code>cancel</code>&#8201;&#8212;&#8201;Use this to cancel on-going replications <sup class="footnoteref">[<a class="footnote" href="#_footnotedef_1" title="View footnote.">1</a>]</sup>.</p>
</li>
</ul>
</div>
<div id="replication-characteristics-highlights" class="exampleblock">
<div class="title">Example 1. Replication Characteristics Highlights</div>
<div class="content">
<div class="tabset is-loading">
<div class="ulist tabs">
<ul>
<li>
<p><a id="tabset1_replication-highlights"></a>Replication highlights</p>
</li>
<li>
<p><a id="tabset1_running-highlights"></a>Running highlights</p>
</li>
</ul>
</div>
<div class="content">
<div class="tab-pane" aria-labelledby="tabset1_replication-highlights">
<div class="ulist">
<ul>
<li>
<p>There are two types of replication: persistent and ad hoc (REST API only).</p>
</li>
<li>
<p>Replications of both types can run in one-shot or continuous replications modes.</p>
</li>
<li>
<p>All replications involve at least one local database.</p>
</li>
<li>
<p>Replications can be configured to purge documents when channel access is revoked (a removal notification is received).</p>
</li>
<li>
<p>Persistent continuous replications can be:</p>
<div class="ulist">
<ul>
<li>
<p>Reset&#8201;&#8212;&#8201;a <a href="../refer/refer-sgw-glossary.html#checkpoint" class="page">checkpoint<span class="image"><img src="../_images/icons/glossaryIconImage2.png" alt="glossary icon" width="14"></span></a> can be reset to zero</p>
</li>
<li>
<p>Updated&#8201;&#8212;&#8201;only the parameter values provided in the PUT request body will be updated</p>
</li>
</ul>
</div>
</li>
<li>
<p>Persistent and ad hoc replications can be:</p>
<div class="ulist">
<ul>
<li>
<p>Removed&#8201;&#8212;&#8201;only the replication_id is needed to delete ongoing continuous or one-shot replications.</p>
</li>
</ul>
</div>
</li>
<li>
<p><a href="https://www.couchbase.com/products/editions">ENTERPRISE EDITION</a> only:</p>
<div class="ulist">
<ul>
<li>
<p>Replications can use delta-sync mode, whereby only the changed data-items are replicated.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="tab-pane" aria-labelledby="tabset1_running-highlights">
<div class="ulist">
<ul>
<li>
<p>Multiple identical replicators can be initiated on a Sync Gateway node provided each has a unique <code>replication_Id</code>.</p>
</li>
<li>
<p>inter-Sync&#160;Gateway replications introduced in Sync Gateway 2.8 as well as SG-Replicate can run on the same node, but you must ensure that they each have a different <code>replication_id</code>.</p>
</li>
<li>
<p>The user under which replication is being run must have read and write access to the data being replicated.</p>
</li>
<li>
<p>Exponential backoff when connection lost; this can be customized using the <a href="../refer/config-properties.html#databases-this_db-replications-this_rep-max_backoff_time" class="page">max_backoff_time</a> configuration setting.</p>
</li>
<li>
<p>replications will continue trying to connect for 30 minutes following authentication failure (including user-invalid/doesn&#8217;t exist).</p>
</li>
<li>
<p>Running replications can be stopped. Stopped replications can be (re)Started.</p>
</li>
<li>
<p>If ALL the Sync Gateway nodes in a source or target Sync Gateway cluster go down in the middle of continuous replication, by default, the system should pick up from the last document that was successfully processed by both sides when the replication/cluster is restarted</p>
</li>
<li>
<p>REST ONLY</p>
<div class="ulist">
<ul>
<li>
<p>POST databases/&#123;db&#125;/_replication creates a replication using the {rep-id} specified in the body or if none specified, a unique UUID.</p>
</li>
<li>
<p>PUT databases/&#123;db&#125;/_replication/{rep-id} upserts replication {rep-id}.</p>
</li>
</ul>
</div>
</li>
<li>
<p><a href="https://www.couchbase.com/products/editions">ENTERPRISE EDITION</a> only:</p>
<div class="ulist">
<ul>
<li>
<p>Replications are distributed even across all available Sync Gateway nodes and so are not guaranteed to run on their originating node.</p>
</li>
<li>
<p>If a multi-node Sync Gateway cluster loses a subset of sync gateway nodes, the remaining nodes continue replication uninterrupted IF they have been configured to handle the replication (continuous and one-shot replications).</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="replication-definition"><a class="anchor" href="#replication-definition"></a>Replication Definition</h2>
<div class="sectionbody">
<div class="paragraph">
<p>All replications are 'initialized' by a <a href="../refer/refer-sgw-glossary.html#replication-definition" class="page">replication definition<span class="image"><img src="../_images/icons/glossaryIconImage2.png" alt="glossary icon" width="14"></span></a> in the configuration file or Admin REST API and operate within the context of a local database.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Configured replications use the <code>database.{db-name}.replications</code> property to add a replication definition to a local database.</p>
</li>
<li>
<p>REST API replications specify the local database and replication identity in the API POST/PUT request.
Providing the replication definition parameters in the request body as a JSON string.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Both scenarios are covered in <a href="#replication-properties">Example 2</a>.
It summarizes the <a href="../refer/refer-sgw-glossary.html#replication-definition" class="page">replication definition<span class="image"><img src="../_images/icons/glossaryIconImage2.png" alt="glossary icon" width="14"></span></a> elements<sup class="footnote" id="_footnote_fn-repdef-both">[<a id="_footnoteref_2" class="footnote" href="#_footnotedef_2" title="View footnote.">2</a>]</sup>, which are covered in more detail in <a href="../refer/config-properties.html" class="page">Configuration File</a>.</p>
</div>
<div class="sect2">
<h3 id="database-level-settings"><a class="anchor" href="#database-level-settings"></a>Database-level Settings</h3>
<div class="paragraph">
<p>A number of database-level options are also especially relevant to Inter-Sync&#160;Gateway Replication, including:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="../refer/config-properties.html#databases-this_db-sgreplicate_enabled" class="page">sgreplicate_enabled</a>&#8201;&#8212;&#8201;use this <a href="https://www.couchbase.com/products/editions">ENTERPRISE EDITION</a> setting to allow the database to participate in Inter-Sync&#160;Gateway Replications.</p>
</li>
<li>
<p><a href="../refer/config-properties.html#databases-this_db-delta_sync" class="page">this_db.delta_sync</a>&#8201;&#8212;&#8201;use this setting to enable delta-sync replication on the database, it must be set if you want to use delta-sync in your <em>replication definition</em>.</p>
</li>
<li>
<p><a href="../refer/config-properties.html#databases-this_db-sgreplicate_websocket_heartbeat_secs" class="page">sgreplicate_websocket_heartbeat_secs</a>&#8201;&#8212;&#8201;use this setting to override the default (5 minute) heartbeat interval for websocket ping frames for this database.</p>
</li>
<li>
<p><a href="../refer/config-properties.html#databases-this_db-sync" class="page">sync</a>&#8201;&#8212;&#8201;use this setting to specify the sync function logic&#8201;&#8212;&#8201;this is an essential part of access-control.</p>
</li>
<li>
<p><a href="../refer/config-properties.html#databases-this_db-unsupported-sgr_tls_skip_verify" class="page">unsupported.sgr_tls_skip_verify</a>&#8201;&#8212;&#8201;use this unsupported option to make development an testing easier by skipping verification of TLS certificates.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="replication-level-settings"><a class="anchor" href="#replication-level-settings"></a>Replication-level Settings</h3>
<div id="replication-properties" class="exampleblock">
<div class="title">Example 2. Replication Definition</div>
<div class="content">
<div class="tabset is-loading">
<div class="ulist tabs">
<ul>
<li>
<p><a id="tabset2_summary-of-parameters"></a>Summary of Parameters</p>
</li>
<li>
<p><a id="tabset2_configured-example"></a>Configured Example</p>
</li>
<li>
<p><a id="tabset2_rest-api-example"></a>REST API Example</p>
</li>
</ul>
</div>
<div class="content">
<div class="tab-pane" aria-labelledby="tabset2_summary-of-parameters">
<div class="paragraph">
<p>This table summarize all the available configurable items. It includes a link to a detailed description of each.</p>
</div>
<table id="replication-definiton-summary" class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name and Link</th>
<th class="tableblock halign-left valign-top">Summary</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a href="../refer/config-properties.html#databases-this_db-replications-this_rep-adhoc" class="page">adhoc</a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>REST API ONLY<br>
Use the Admin REST API&#8217;s <code>adhoc</code> parameter to specify that a replication is ad hoc rather than persistent.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a href="../refer/config-properties.html#databases-this_db-replications-this_rep-batch_size" class="page">batch_size</a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Use <code>batch_size</code> to specify the number of changes to be included in a single batch during replication.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a href="../refer/config-properties.html#databases-this_db-replications-this_rep-cancel" class="page">cancel</a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>REST API ONLY<br>
Use the Admin REST API&#8217;s <code>cancel</code> parameter only when you want to want to cancel an existing active replication.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a href="../refer/config-properties.html#databases-this_db-replications-this_rep-conflict_resolution_type" class="page">conflict_resolution_type</a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Use <code>conflict_resolution_type</code> to specify how Sync Gateway should resolve conflicts. By default the automatic conflict resolution policy is applied.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a href="../refer/config-properties.html#databases-this_db-replications-this_rep-continuous" class="page">continuous</a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Use <code>continuous</code> to specify whether this replication will run continuously, or be one-shot.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a href="../refer/config-properties.html#databases-this_db-replications-this_rep-custom_conflict_resolver" class="page">custom_conflict_resolver</a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Use <code>custom_conflict_resolver</code> to provide the Javascript function used to resolve conflicts if <code>"conflict_resolution_type": "custom"</code>.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a href="../refer/config-properties.html#databases-this_db-replications-this_rep-direction" class="page">direction</a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Use <code>direction</code> to specify the replication is <strong>push</strong>, <strong>pull</strong> or <strong>pushAndPull</strong> relative to this node.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a href="../refer/config-properties.html#databases-this_db-replications-this_rep-enable_delta_sync" class="page">enable_delta_sync</a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Use <code>enable_delta_sync</code> to specify use of delta sync for a replication.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a href="../refer/config-properties.html#databases-this_db-replications-this_rep-filter" class="page">filter</a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Use <code>filter</code> to specify the name of the function to be used to filter documents.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a href="../refer/config-properties.html#databases-this_db-replications-this_rep-max_backoff_time" class="page">max_backoff_time</a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Use <code>max_backoff_time</code> to specify the number of minutes Sync Gateway will spend trying to reconnect lost or unreachable <code>remote</code> targets.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a href="../refer/config-properties.html#databases-this_db-replications-this_rep-purge_on_removal" class="page">purge_on_removal</a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Use <code>purge_on_removal</code> to specify (per replication) whether removing a <code>channel</code> should trigger a purge.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a href="../refer/config-properties.html#databases-this_db-replications-this_rep-query_params" class="page">query_params</a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Use <code>query_params</code> to specify the key/value pairs to be passed to the filter named in <code>filter</code>.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a href="../refer/config-properties.html#databases-this_db-replications-this_rep-remote" class="page">remote</a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Use <code>remote</code> to specify the database endpoint on the remote Sync Gateway custer.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a href="../refer/config-properties.html#databases-this_db-replications-this_rep-replication_id" class="page">replication_id</a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Use <code>replication_id</code> to specify an identifying name for the replication.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a href="../refer/config-properties.html#databases-this_db-replications-this_rep-initial_state" class="page">initial_state</a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Use <code>initial_state</code> to specify the state in which to launch the replication.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="tab-pane" aria-labelledby="tabset2_configured-example">
<div class="paragraph">
<p>This is an example of a replication definition. Its purpose is to illustrate all configurable items in use and so should not be considered a working example.</p>
</div>
<div class="paragraph">
<p>It creates a replication with the replication_ID of <code>db1-rep-id1-pull-oneshot</code> on a local database <code>db1-local_</code>, pulling data from a remote database <code>db1-remote</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json" data-source-url="https://github.com/ibsoln/docs-sync-gateway/blob/undefined/modules/ROOT/examples/configuration/sync-gateway-config.json#L932-L957">"databases": {
 " db1": {                                                <i class="conum" data-value="1"></i><b>(1)</b>
    "bucket":"db1",
    "server": "couchbase://cb-server",
    // ... other DB config ..
    "sgreplicate_enabled": true,                          <i class="conum" data-value="2"></i><b>(2)</b>
    "replications":
      "db1-rep-id1-pull-oneshot":                         <i class="conum" data-value="3"></i><b>(3)</b>
        "direction": "pull",                              <i class="conum" data-value="4"></i><b>(4)</b>
        "remote": "https://example.com:4984/remote_db1",
        "user": "user1",                                  <i class="conum" data-value="5"></i><b>(5)</b>
        "password": "password",
        "batch_size": 1000,                               <i class="conum" data-value="6"></i><b>(6)</b>
        "conflict_resolution_type": "custom",             <i class="conum" data-value="7"></i><b>(7)</b>
        "custom_conflict_resolver": "",                   <i class="conum" data-value="8"></i><b>(8)</b>
        "continuous": false,                              <i class="conum" data-value="9"></i><b>(9)</b>
        "enable_delta_sync": false,                       <i class="conum" data-value="10"></i><b>(10)</b>
        "filter": "sync_gateway/bychannel",               <i class="conum" data-value="11"></i><b>(11)</b>
        "query_params": ["channel.user1"]                 <i class="conum" data-value="12"></i><b>(12)</b>
        "max_backoff_time": 5,                            <i class="conum" data-value="13"></i><b>(13)</b>
        "purge_on_removal": false                         <i class="conum" data-value="14"></i><b>(14)</b>
        "state": "running"                                <i class="conum" data-value="15"></i><b>(15)</b>
    }
  }</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>All replications are defined at database level within the context of a local database (e.g. <code>DB1</code>)</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Opt in to replication</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Define the <code>replication_id</code></td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Pull changes from the <code>remote</code> database at the specified url.<br></td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>Authenticate with the provided credentials. This user must have read and write access to both the local and remote databases.<br></td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td>Batch together up to 1000 revisions at a time. This improve replication performance but consumes more memory resources.<br></td>
</tr>
<tr>
<td><i class="conum" data-value="7"></i><b>7</b></td>
<td>Apply a custom conflict resolution policy.<br></td>
</tr>
<tr>
<td><i class="conum" data-value="8"></i><b>8</b></td>
<td>Provide a working Javascript function to apply the required resolution policy.</td>
</tr>
<tr>
<td><i class="conum" data-value="9"></i><b>9</b></td>
<td>By setting continuous=false, we are creating a one-shot replication. We could also have omitted this parameter as it defaults to <code>false</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="10"></i><b>10</b></td>
<td>Don&#8217;t use delta-sync; the default behavior.</td>
</tr>
<tr>
<td><i class="conum" data-value="11"></i><b>11</b></td>
<td>Filter documents by channel.<br></td>
</tr>
<tr>
<td><i class="conum" data-value="12"></i><b>12</b></td>
<td>Replicate only those documents tagged with the channel names "user1".<br></td>
</tr>
<tr>
<td><i class="conum" data-value="13"></i><b>13</b></td>
<td>Wait no more than 5 minutes between retries after network failure; default behavior.<br></td>
</tr>
<tr>
<td><i class="conum" data-value="14"></i><b>14</b></td>
<td>Don&#8217;t purge following removal of a channel; the default behavior.<br></td>
</tr>
<tr>
<td><i class="conum" data-value="15"></i><b>15</b></td>
<td>Start the replicator immediately and on Sync Gateway node re(start);. We could also have omitted this parameter as this is the default behavior.</td>
</tr>
</table>
</div>
</div>
<div class="tab-pane" aria-labelledby="tabset2_rest-api-example">
<div class="paragraph">
<p>This is an example of a replication definition as you might submit it to the Admin REST API.using <code>curl</code>.
Its purpose is to illustrate all configurable items in use and so should not be considered a working example.</p>
</div>
<div class="paragraph">
<p>It creates a replication with the replication_ID of <code>db1-rep-id1-pull-oneshot</code> on a local database <code>db1-local_</code>, pulling data from a remote database <code>db1-remote</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">curl --location --request POST 'http://localhost:4985/db1-local/_replication/db1-rep-id1-pull-oneshot' \ <i class="conum" data-value="1"></i><b>(1)</b>
--header 'Content-Type: application/json' \
--dataraw '{
"replication_id": "db1-rep-id1-pull-oneshot" <i class="conum" data-value="2"></i><b>(2)</b>
        "direction": "pull",                              <i class="conum" data-value="3"></i><b>(3)</b>
        "remote": "https://example.com:4984/remote_db1",
        "user": "user1",                                  <i class="conum" data-value="4"></i><b>(4)</b>
        "password": "password",
        "batch_size": 1000,                               <i class="conum" data-value="5"></i><b>(5)</b>
        "conflict_resolution_type": "custom",             <i class="conum" data-value="6"></i><b>(6)</b>
        "custom_conflict_resolver": "",                   <i class="conum" data-value="7"></i><b>(7)</b>
        "continuous": false,                              <i class="conum" data-value="8"></i><b>(8)</b>
        "enable_delta_sync": false,                       <i class="conum" data-value="9"></i><b>(9)</b>
        "filter": "sync_gateway/bychannel",               <i class="conum" data-value="10"></i><b>(10)</b>
        "query_params": ["channel.user1"]                 <i class="conum" data-value="11"></i><b>(11)</b>
        "max_backoff_time": 5,                            <i class="conum" data-value="12"></i><b>(12)</b>
        "purge_on_removal": false                         <i class="conum" data-value="13"></i><b>(13)</b>
        "state": "running"                                <i class="conum" data-value="14"></i><b>(14)</b>
  "adhoc": false, <i class="conum" data-value="15"></i><b>(15)</b>
  "cancel": false <i class="conum" data-value="16"></i><b>(16)</b>
}'</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>All replications take place at database level and in the context of a local database. Here we are setting the replication in the context of <code>db1-local</code></td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Define the <code>replication_id</code></td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Pull changes from the <code>remote</code> database at the specified url.<br></td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Authenticate with the provided credentials. This user must have read and write access to both the local and remote databases.<br></td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>Batch together up to 1000 revisions at a time. This improve replication performance but consumes more memory resources.<br></td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td>Apply a custom conflict resolution policy.<br></td>
</tr>
<tr>
<td><i class="conum" data-value="7"></i><b>7</b></td>
<td>Provide a working Javascript function to apply the required resolution policy.</td>
</tr>
<tr>
<td><i class="conum" data-value="8"></i><b>8</b></td>
<td>By setting continuous=false, we are creating a one-shot replication. We could also have omitted this parameter as it defaults to <code>false</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="9"></i><b>9</b></td>
<td>Don&#8217;t use delta-sync; the default behavior.</td>
</tr>
<tr>
<td><i class="conum" data-value="10"></i><b>10</b></td>
<td>Filter documents by channel.<br></td>
</tr>
<tr>
<td><i class="conum" data-value="11"></i><b>11</b></td>
<td>Replicate only those documents tagged with the channel names "user1".<br></td>
</tr>
<tr>
<td><i class="conum" data-value="12"></i><b>12</b></td>
<td>Wait no more than 5 minutes between retries after network failure; default behavior.<br></td>
</tr>
<tr>
<td><i class="conum" data-value="13"></i><b>13</b></td>
<td>Don&#8217;t purge following removal of a channel; the default behavior.<br></td>
</tr>
<tr>
<td><i class="conum" data-value="14"></i><b>14</b></td>
<td>Start the replicator immediately and on Sync Gateway node re(start);. We could also have omitted this parameter as this is the default behavior.</td>
</tr>
<tr>
<td><i class="conum" data-value="15"></i><b>15</b></td>
<td>Setting <code>adhoc=false</code> marks this as a persistent replication. The definition will survive Sync Gateway node restarts. This the default behaviour if this parameter is omitted.+</td>
</tr>
<tr>
<td><i class="conum" data-value="16"></i><b>16</b></td>
<td>Set <code>cancel=true</code> to cancel an initialized replication; otherwise you can omit this parameter.</td>
</tr>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="generic-constraints"><a class="anchor" href="#generic-constraints"></a>Generic Constraints</h2>
<div class="sectionbody">
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
<div class="title">Replication</div>
<div class="paragraph">
<p>All active nodes in an active cluster must be running Sync Gateway version 2.8+.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="https://www.couchbase.com/products/editions">ENTERPRISE EDITION</a></dt>
<dd>
<p>All replications are distributed evenly across available nodes. This means they cannot be guaranteed to run on the node from which they originate.</p>
</dd>
<dt class="hdlist1">Access rights</dt>
<dd>
<p>The user running the replication must have read and write access to the data being replicated.
This is not enforced by the system.
Use your <code>sync</code> function to ensure a consistent approach is applied across all clusters.</p>
</dd>
<dt class="hdlist1">Mixing Inter-Sync Gateway Replication Versions</dt>
<dd>
<p>Versions of inter-Sync Gateway replications pre- and post-2.8 can legitimately be in use at the same time, especially during transition.
However, you should avoid initializing identical pre-2.8 (SG Replicate) and 2.8+ replications.</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="sect1">
<h2 id="running-configured-replications"><a class="anchor" href="#running-configured-replications"></a>Running Configured Replications</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Replications in the configuration file start automatically whenever Sync Gateway is (re)started.
Unless you inhibit this by adding an <code>"initial_state": "stopped"</code> parameter to the replication definition&#8201;&#8212;&#8201;see: <a href="../refer/config-properties.html#databases-this_db-replications-this_rep-initial_state" class="page">initial_state</a>.
You can manually start 'stopped' replication using <a href="icr-admin.html#starting-a-replication" class="page">Starting a replication</a>.</p>
</div>
<div class="exampleblock">
<div class="title">Example 3. Configured Replications&#8201;&#8212;&#8201;Continuous and One-shot</div>
<div class="content">
<div class="tabset is-loading">
<div class="ulist tabs">
<ul>
<li>
<p><a id="tabset3_continuous"></a>Continuous</p>
</li>
<li>
<p><a id="tabset3_one-shot"></a>One-shot</p>
</li>
</ul>
</div>
<div class="content">
<div class="tab-pane" aria-labelledby="tabset3_continuous">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json" data-source-url="https://github.com/ibsoln/docs-sync-gateway/blob/undefined/modules/ROOT/examples/configuration/sync-gateway-config.json">//  . . . other configuration entries
"db1-rep-id1-pull-cont":
  "replication_id": "db1-rep-id1-pull-cont",
  "direction": "pull",
  "continuous": true <i class="conum" data-value="1"></i><b>(1)</b>
  "purge-on-removal": true,
  "remote": "http://user:password@example.com:4985/db1-remote",
  "filter":"sync_gateway/bychannel",
  "query_params": {
    "channels": ["channel1.user1"]
  }
//  . . . other configuration entries</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Make this a continuous replication that remains running, listening for changes to process.
Because it is also persistent, it will start automatically following Sync Gateway node restarts (<code>state</code> defaults to <code>running</code>).</td>
</tr>
</table>
</div>
</div>
<div class="tab-pane" aria-labelledby="tabset3_one-shot">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json" data-source-url="https://github.com/ibsoln/docs-sync-gateway/blob/undefined/modules/ROOT/examples/configuration/sync-gateway-config.json#L874-L883">//. . . other configuration entries
"db1-rep-id3-pull-oneshot":
"replication_id": "db1-rep-id3-pull-oneshot", <i class="conum" data-value="1"></i><b>(1)</b>
"direction": "pull",
"remote": "http://user:password@example.com:4985/db1-remote",
"filter": "sync_gateway/bychannel",
"query_params": { "channels": ["channel1.user1"] }
//  . . . other configuration entries</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>This a a one-shot replication because the <code>continuous</code> parameter defaults to <code>false</code>.</td>
</tr>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="running-admin-rest-api-replications"><a class="anchor" href="#running-admin-rest-api-replications"></a>Running Admin REST API Replications</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Replications initialized by sending a <code>POST</code>, or <code>PUT</code>, request to the <code>_replication</code> endpoint will start running automatically, unless the <code>"initial_state": "stopped"</code> parameter is specified. with a JSON object defining the replication parameters&#8201;&#8212;&#8201;as shown in  <a href="#submitting-api-requests">Example 4</a>.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>You can run multiple replications simultaneously with different replication topologies, provided both databases being synchronized have the same sync function.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You can submit requests using the <code>curl</code> utility (as in these examples) or an application such as <em>Postman</em>.</p>
</div>
<div id="submitting-api-requests" class="exampleblock">
<div class="title">Example 4. Submitting API Requests</div>
<div class="content">
<div class="tabset is-loading">
<div class="ulist tabs">
<ul>
<li>
<p><a id="tabset4_continuous-pull-replication"></a>Continuous Pull Replication</p>
</li>
<li>
<p><a id="tabset4_one-shot"></a>One-shot</p>
</li>
<li>
<p><a id="tabset4_ad-hoc"></a>Ad-hoc</p>
</li>
</ul>
</div>
<div class="content">
<div class="tab-pane" aria-labelledby="tabset4_continuous-pull-replication">
<div class="paragraph">
<p>This example initializes a persistent, continuous, replication between a local database and one on a remote Sync Gateway instance.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">curl --location --request POST 'http://localhost:4985/db1-local/_replication/' \
--header 'Content-Type: application/json' \
--dataraw '{
  "replication_id": "db1-rep-id1-pull-cont",
  "direction": "pull",
  "continuous": true <i class="conum" data-value="1"></i><b>(1)</b>
  "purge-on-removal": true,
  "remote": "http://user:password@example.com:4985/db1-remote",
  "filter":"sync_gateway/bychannel",
  "query_params": {
    "channels": ["channel1.user1"]
  }
}'</code></pre>
</div>
</div>
</div>
<div class="tab-pane" aria-labelledby="tabset4_one-shot">
<div class="paragraph">
<p>This example initializes a persistent, one-shot, replication between a local database and one on a remote Sync Gateway instance.</p>
</div>
<div class="paragraph">
<p>The replication will run once, after a short delay to allow the Rest API to start.
It will then run once after each Sync Gateway restart and-or when manually initiated using the <code>_replicationStatus</code> endpoint&#8201;&#8212;&#8201;see <a href="icr-admin.html" class="page">Manage Inter-Sync Gateway Replications</a>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">curl --location --request POST 'http://localhost:4985/db1-local/_replication/' \
--header 'Content-Type: application/json' \
--dataraw '{
"replication_id": "db1-rep-id3-pull-oneshot", <i class="conum" data-value="1"></i><b>(1)</b>
"direction": "pull",
"remote": "http://user:password@example.com:4985/db1-remote",
"filter": "sync_gateway/bychannel",
"query_params": { "channels": ["channel1.user1"] }
}'</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>This a a one-shot replication because the <code>continuous</code> parameter defaults to <code>false</code>.</td>
</tr>
</table>
</div>
</div>
<div class="tab-pane" aria-labelledby="tabset4_ad-hoc">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">curl --location --request POST 'http://localhost:4985/db1-local/_replication/' \
--header 'Content-Type: application/json' \
--dataraw '{
  "replication_id": "db1-rep-id1-pull-adhoc",
  "adhoc": true, <i class="conum" data-value="1"></i><b>(1)</b>
  "direction": "pull",
  "purge-on-removal": true,
  "remote": "http://user:password@example.com:4985/db1-remote",
  "filter":"sync_gateway/bychannel",
  "query_params": {
    "channels": ["channel1.user1"]
  }
}'</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Run this replication as an ad hoc one. It will run once only, process all changes but not survive Sync Gateway restarts</td>
</tr>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="related-content"><a class="anchor" href="#related-content"></a>Related Content</h2>
<div class="sectionbody">
<div class="card-row three-column-row">
<div class="sect5 column">
<h6 id=""><a class="anchor" href="#"></a></h6>
<div class="ulist">
<div class="title">Learn more ...</div>
<ul>
<li>
<p><a href="icr-sgreplicate.html" class="page">Inter-Sync Gateway Replication</a></p>
</li>
<li>
<p><a href="icr-sgreplicate-sgr1.html" class="page">Inter-Sync Gateway Replication pre-2.8</a></p>
</li>
<li>
<p><a href="../shared-bucket-access.html" class="page">Sync with Couchbase Server</a></p>
</li>
</ul>
</div>
</div>
<div class="sect5 column">
<h6 id="-2"><a class="anchor" href="#-2"></a></h6>
<div class="ulist">
<div class="title">Reference material ...</div>
<ul>
<li>
<p><a href="../refer/config-properties.html" class="page">Configuration File</a></p>
</li>
<li>
<p><a href="../refer/rest-api-public.html" class="page">Public REST API</a></p>
</li>
<li>
<p><a href="../refer/rest-api-admin.html" class="page">Admin REST API</a></p>
</li>
<li>
<p><a href="../refer/rest-api-metrics.html" class="page">Metrics REST API</a></p>
</li>
<li>
<p><a href="../advance/adv-rest-api-client.html" class="page">Use the REST API?</a></p>
</li>
</ul>
</div>
</div>
<div class="sect5 column">
<h6 id="-3"><a class="anchor" href="#-3"></a></h6>
<div class="ulist">
<div class="title">Community</div>
<ul>
<li>
<p><a href="https://forums.couchbase.com/c/mobile/14">Forum</a>  <strong>|</strong>  <a href="https://blog.couchbase.com/">Blog</a>   <strong>|</strong>  <a href="https://docs.couchbase.com/tutorials/index.html">Tutorials</a></p>
</li>
</ul>
</div>
<div class="ulist">
<div class="title">Conflict Related Blogs</div>
<ul>
<li>
<p><a href="https://blog.couchbase.com/document-conflicts-couchbase-mobile/">Automatic Conflict Resolution</a></p>
</li>
<li>
<p><a href="https://blog.couchbase.com/conflict-resolution-couchbase-mobile/">Demystifying Conflict Resolution</a></p>
</li>
<li>
<p><a href="https://blog.couchbase.com/tag/conflict-resolution/">Conflict Resolution (category)</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div id="footnotes">
<hr>
<div class="footnote" id="_footnotedef_1">
<a href="#_footnoteref_1">1</a>. This parameter is not available in the configuration file.
</div>
<div class="footnote" id="_footnotedef_2">
<a href="#_footnoteref_2">2</a>. The definitions apply to configured and API replications).
</div>
</div>
</article>
</main>
</div>
<footer class="footer">
  <div class="container">
    <div class="footer-links">
      <div class="col">
        <div class="footer-logo">
          <a href="https://www.couchbase.com" class="icon">
            <img src="../../../_/img/couchbase_logo_black.svg" alt="Couchbase">
          </a>
        </div>
      </div>
      <div class="col">
        <ul>
          <li><a href="https://docs.couchbase.com" target="_blank" rel="noopener">Documentation</a></li>
          <li><a href="https://forums.couchbase.com" target="_blank" rel="noopener">Forums</a></li>
          <li><a href="https://support.couchbase.com" target="_blank" rel="noopener">Support</a></li>
        </ul>
      </div>
      <div class="col">
        <ul>
          <li><a href="https://developer.couchbase.com" target="_blank" rel="noopener">Developer Portal</a></li>
          <li><a href="https://blog.couchbase.com" target="_blank" rel="noopener">Blog</a></li>
          <li><a href="https://www.couchbase.com/resources">Resources</a></li>
        </ul>
      </div>
      <div class="col">
        <ul>
          <li><a href="https://www.couchbase.com/get-started-developing-nosql">Get Started</a></li>
          <li><a href="https://www.couchbase.com/downloads">Downloads</a></li>
          <li><a href="https://learn.couchbase.com/store?utf8=%E2%9C%93&ss=1&ct=78327&commit=Filter" target="_blank" rel="noopener">Training</a></li>
        </ul>
      </div>
      <div class="col">
        <ul class="social-icons">
          <li>
            <svg  width="14" height="14" viewBox="0 0 32 32"> <path id="facebook" class="cls-1" d="M29,0H3A2.652,2.652,0,0,0,0,3V29a2.652,2.652,0,0,0,3,3H16V18H12V14h4V12a6.452,6.452,0,0,1,6-6h4v4H22a2.151,2.151,0,0,0-2,2v2h6l-1,4H20V32h9a2.652,2.652,0,0,0,3-3V3A2.652,2.652,0,0,0,29,0Z"/></svg>
            <a href="https://www.facebook.com/Couchbase" class="icon">
            Facebook
            </a>
          </li>
          <li>
            <svg  width="14" height="14" viewBox="0 0 32.1 26.1"> <path id="twitter" class="cls-1" d="M32,7.1a11.836,11.836,0,0,1-3.8,1,6.462,6.462,0,0,0,2.9-3.6,12.606,12.606,0,0,1-4.2,1.6A6.492,6.492,0,0,0,22.1,4a6.594,6.594,0,0,0-6.6,6.6,7.719,7.719,0,0,0,.2,1.5A18.458,18.458,0,0,1,2.2,5.2a6.294,6.294,0,0,0-.9,3.3A6.765,6.765,0,0,0,4.2,14a6.109,6.109,0,0,1-3-.8v.1a6.543,6.543,0,0,0,5.3,6.4,4.678,4.678,0,0,1-1.7.2,4.869,4.869,0,0,1-1.2-.1,6.679,6.679,0,0,0,6.1,4.6,12.917,12.917,0,0,1-8.2,2.8,9.151,9.151,0,0,1-1.6-.1,18.438,18.438,0,0,0,10.1,3c12.1,0,18.7-10,18.7-18.7v-.8A13.336,13.336,0,0,0,32,7.2Z" transform="translate(0.1 -4)"/></svg>
            <a href="https://twitter.com/couchbase" class="icon">
              Twitter
            </a>
          </li>
          <li>
          <svg  width="14" height="14" viewBox="0 0 32 32"> <path id="linkedin" class="cls-1" d="M29,0H3A3.076,3.076,0,0,0,0,3V29a3.009,3.009,0,0,0,3,3H29a2.946,2.946,0,0,0,3-3V3A3.009,3.009,0,0,0,29,0ZM12,26H8V12h4ZM10,10a2,2,0,1,1,2-2A2.006,2.006,0,0,1,10,10ZM26,26H22V18a2,2,0,0,0-4,0v8H14V12h4v2.5c.8-1.1,2.1-2.5,3.5-2.5A4.736,4.736,0,0,1,26,17Z"/></svg>
              <a href="https://www.linkedin.com/company/couchbase" class="icon">
             Linkedin
            </a>
          </li>
        </ul>
      </div>
    </div>
    <div class="footer-terms">
      <div class="footer-terms-copyright">
          <span> 2021 Couchbase, Inc. Couchbase, Couchbase Lite and the Couchbase logo are registered trademarks of Couchbase, Inc.</span>
      </div>
      <div class="footer-terms-links">
        <a href="https://www.couchbase.com/terms-of-use">Terms of Use</a>
        <a href="https://www.couchbase.com/privacy-policy">Privacy Policy</a>
        <a href="https://www.couchbase.com/cookie-policy">Cookie Policy</a>
        <a href="https://www.couchbase.com/support-policy">Support Policy</a>
        <a href="https://info.couchbase.com/unsubscribe-or-manage-preferences.html" target="_blank" rel="noopener">Marketing Preference Center</a>
      </div>
    </div>
  </div>
</footer>
<script src="../../../_/js/site.js"></script>
<script async src="../../../_/js/vendor/fontawesome-icon-defs.js"></script>
<script async src="../../../_/js/vendor/fontawesome.js"></script>
<script async src="../../../_/js/vendor/highlight.js"></script>
</body>
</html>
