<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>User Authentication | Couchbase Docs Preview Site</title>
<link rel="canonical" href="https://ibsoln.github.io/sync-gateway/2.8/learn/authentication.html">
<link rel="stylesheet" href="../../../_/css/site.css">
<script src="../../../_/js/vendor/jquery.js"></script>
<meta name="description" content="Access Sync Gateway securely to sync from cloud to edge">
<link rel="schema.dcterms" href="https://purl.org/dc/terms/">
<meta name="dcterms.subject" content="sync-gateway">
<meta name="dcterms.identifier" content="2.8">
<meta name="generator" content="Antora 2.3.3">
<link rel="icon" href="../../../_/img/favicon.ico" type="image/x-icon">
</head>
<body class="article">
<header class="header fixed-top">
  <div class="header-top-row">
      <div class="container">
          <nav class="navbar navbar-expand-md flex-nowrap justify-content-between navbar-new-top">

              <a class="navbar-brand" href="https://www.couchbase.com">
                <img src="../../../_/img/couchbase-documentation-logo.svg" alt="Couchbase" />
              </a>
              <button class="navbar-burger" data-target="topbar-menu">
                <span></span>
                <span></span>
                <span></span>
              </button>

          </nav>
      </div>
  </div>
  <div class="header-bottom-row" id="topbar-menu">
    <div class="container">
        <nav  class="navbar navbar-new-bottom">

              <div class="navbar-collapse collapse" id="navbar2">
                <ul class="navbar-nav w-100 justify-content-start">
                  <li class="nav-item">
                    <a href="https://ibsoln.github.io/home/index.html" class="nav-link">
                      <i class="fas fa-home"></i>
                    </a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="../../../home/server.html">
                      Server
                    </a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="../../../home/mobile.html">
                      Mobile
                    </a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="../../../home/cloud.html">
                      Cloud
                    </a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="../../../home/sdk.html">
                      SDKs
                    </a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="../../../tutorials/index.html">
                      Tutorials
                      <span class="arrow">
                        <i class="fas fa-arrow-right"></i>
                      </span>
                    </a>
                  </li>
                </ul>
              </div>
              <div class="primary-action">
                <form class="navbar-item search">
                  <input type="text" placeholder="Search Docs" class="query" id="search-query" />
                  <button type="button" class="search-btn">
                    <i class="fas fa-search"></i>
                  </button>
                </form>
                <a class="btn btn-primary try-btn" href="https://www.couchbase.com/downloads">
                  Downloads
                </a>
              </div>

        </nav>
    </div>
   </div>
</header>
<div class="body container">
<nav class="nav">
<div class="left-sidebar-menu">
<div class="version-control-box">
<div class="component-frame">
<div class="frame-icon">
<img src="../../../_/img/server-icon.png" alt="">
</div>
<div class="frame-body">
<h4 class="title"><span class="">Sync Gateway</span></h4>
<a class="frame-link component" href="../index.html"> <span class="version">2.8</span></a>
</div>
</div>
</div>
<div class="nav-menu">
<ul class="nav-list">
<li class="nav-item is-current-path is-active is-active-depth-2  " data-depth="0">

<span class="nav-line "  data-depth="0">
<span class="in-toggle" data-depth="0"></span>
<a class="nav-link" href="../index.html">Sync Gateway</a>
</span>
<ul class="nav-list">
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<a class="nav-link" href="../sgw-whatsnew.html">What&#8217;s New</a>
</span>
</li>
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<span class="in-toggle" data-depth="1"></span>
<a class="nav-link" href="../introduction.html">Start Here!</a>
</span>
<ul class="nav-list">
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../start/gs-sgw-prereqs.html">Prepare</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../start/gs-sgw-install.html">Install</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../start/gs-sgw-config.html">Verify</a>
</span>
</li>
</ul>
</li>
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<a class="nav-link" href="../data-modeling.html">Data Modelling</a>
</span>
</li>
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<span class="in-toggle" data-depth="1"></span>
<span class="nav-text ">Concepts</span>
</span>
<ul class="nav-list">
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="users-and-roles.html">Users</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="roles.html">Roles</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="sync-gateway-channels.html">Channels</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="concept-fundamentals-data-tombstones.html">Tombstones</a>
</span>
</li>
</ul>
</li>
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<a class="nav-link" href="../refer/config-properties.html">Configuration File</a>
</span>
</li>
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<span class="in-toggle" data-depth="1"></span>
<a class="nav-link" href="../start/gs-sgw-api-access.html">REST API Access</a>
</span>
<ul class="nav-list">
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../refer/rest-api-public.html">Public REST API</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../refer/rest-api-admin.html">Admin REST API</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../refer/rest-api-metrics.html">Metrics REST API</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../advance/adv-rest-api-client.html">REST API Client</a>
</span>
</li>
</ul>
</li>
<li class="nav-item is-current-path is-active is-active-depth-2  " data-depth="1">

<span class="nav-line "  data-depth="1">
<span class="in-toggle" data-depth="1"></span>
<span class="nav-text ">Security</span>
</span>
<ul class="nav-list">
<li class="nav-item is-current-page is-active is-active-depth-2  " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="authentication.html">User Authentication</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../security.html">TLS Certificate Authentication</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<span class="in-toggle" data-depth="2"></span>
<span class="nav-text ">Access Control</span>
</span>
<ul class="nav-list">
<li class="nav-item " data-depth="3">

<span class="nav-line "  data-depth="3">
<a class="nav-link" href="defining-sync-functions.html">Sync Function</a>
</span>
</li>
<li class="nav-item " data-depth="3">

<span class="nav-line "  data-depth="3">
<a class="nav-link" href="../advance/adv-sgw-cfg-import-filter.html">Import filter</a>
</span>
</li>
<li class="nav-item " data-depth="3">

<span class="nav-line "  data-depth="3">
<a class="nav-link" href="read-access.html">Read Access</a>
</span>
</li>
<li class="nav-item " data-depth="3">

<span class="nav-line "  data-depth="3">
<a class="nav-link" href="write-access.html">Write Access</a>
</span>
</li>
</ul>
</li>
</ul>
</li>
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<span class="in-toggle" data-depth="1"></span>
<span class="nav-text ">Sync</span>
</span>
<ul class="nav-list">
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../shared-bucket-access.html">Sync with Couchbase Server</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../sync-from-client.html">Sync with Couchbase Lite</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<span class="in-toggle" data-depth="2"></span>
<a class="nav-link" href="icr-sgreplicate.html">Inter-Sync Gateway Replication</a>
</span>
<ul class="nav-list">
<li class="nav-item " data-depth="3">

<span class="nav-line "  data-depth="3">
<a class="nav-link" href="icr-running.html">Initialize</a>
</span>
</li>
<li class="nav-item " data-depth="3">

<span class="nav-line "  data-depth="3">
<a class="nav-link" href="icr-admin.html">Manage</a>
</span>
</li>
<li class="nav-item " data-depth="3">

<span class="nav-line "  data-depth="3">
<a class="nav-link" href="icr-monitoring.html">Monitor</a>
</span>
</li>
</ul>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../managing-tombstones.html">Managing Tombstones</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../delta-sync.html">Delta Sync</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../resync.html">Resync</a>
</span>
</li>
</ul>
</li>
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<span class="in-toggle" data-depth="1"></span>
<span class="nav-text ">Manage</span>
</span>
<ul class="nav-list">
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../stats-monitoring.html">Monitor</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<span class="in-toggle" data-depth="2"></span>
<span class="nav-text ">Logging and Troubleshooting</span>
</span>
<ul class="nav-list">
<li class="nav-item " data-depth="3">

<span class="nav-line "  data-depth="3">
<a class="nav-link" href="../advance/logging.html">Logging</a>
</span>
</li>
<li class="nav-item " data-depth="3">

<span class="nav-line "  data-depth="3">
<a class="nav-link" href="../sgcollect-info.html">SG Collect</a>
</span>
</li>
</ul>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../database-offline.html">Take Database Offline/Online</a>
</span>
</li>
</ul>
</li>
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<span class="in-toggle" data-depth="1"></span>
<span class="nav-text ">Integrate</span>
</span>
<ul class="nav-list">
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../events.html">Event Handling</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../server-integration.html">Changes Feed</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../integrating-external-stores.html">External Stores</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../stats-prometheus.html">Prometheus Feed</a>
</span>
</li>
</ul>
</li>
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<span class="in-toggle" data-depth="1"></span>
<a class="nav-link" href="../deployment.html">Deploy</a>
</span>
<ul class="nav-list">
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../command-line-options.html">Using Command Line</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../load-balancer.html">Load Balancer</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../os-level-tuning.html">OS-level Tuning</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../indexing.html">Indexing versus Views</a>
</span>
</li>
</ul>
</li>
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<a class="nav-link" href="../advance/deploy/upgrade.html">Upgrade</a>
</span>
</li>
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<span class="in-toggle" data-depth="1"></span>
<span class="nav-text ">Use Kubernetes</span>
</span>
<ul class="nav-list">
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../advance/kubernetes/deploy-cluster.html">Deploy</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="#operator::tutorial-sync-gateway-manage.adoc">Manage a Sync Gateway Cluster</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="#operator::tutorial-sync-gateway-clients.adoc">Expose Sync Gateway to Couchbase Lite clients</a>
</span>
</li>
</ul>
</li>
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<span class="in-toggle" data-depth="1"></span>
<span class="nav-text ">Product Notes</span>
</span>
<ul class="nav-list">
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../prodnotes/pn-release-notes.html">Release Notes</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../prodnotes/pn-supported-os.html">Supported OS</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../prodnotes/pn-compatibility.html">Compatibility Matrix</a>
</span>
</li>
</ul>
</li>
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<span class="in-toggle" data-depth="1"></span>
<span class="nav-text ">Legacy Features</span>
</span>
<ul class="nav-list">
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../resolving-conflicts.html">Conflict Resolution 1.x Clients</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="icr-sgreplicate-sgr1.html">Inter-Sync Gateway Replication pre-2.8</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="logging-legacy-pre2-1.html">Log Rotation pre-2.1</a>
</span>
</li>
</ul>
</li>
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<a class="nav-link" href="../refer/refer-sgw-glossary.html">Sync Gateway Glossary</a>
</span>
</li>
</ul>
</li>
<li class="nav-item " data-depth="0">

<span class="nav-line "  data-depth="0">
<span class="in-toggle" data-depth="0"></span>
<a class="nav-link" href="../../../couchbase-lite/2.8/introduction.html">Couchbase Lite</a>
</span>
<ul class="nav-list">
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<a class="nav-link" href="../../../couchbase-lite/2.8/android/quickstart.html">Android (Java)</a>
</span>
</li>
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<a class="nav-link" href="../../../couchbase-lite/2.8/csharp/quickstart.html">C#</a>
</span>
</li>
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<a class="nav-link" href="../../../couchbase-lite/2.8/java/quickstart.html">Java</a>
</span>
</li>
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<a class="nav-link" href="../../../couchbase-lite/2.8/objc/quickstart.html">Objective-C</a>
</span>
</li>
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<a class="nav-link" href="../../../couchbase-lite/2.8/swift/quickstart.html">Swift</a>
</span>
</li>
</ul>
</li>
</ul>
</div>
<a href="#" class="menu-expand-toggle"> <span>Navigation</span> <i class="fas fa-times-circle"></i> <i class="fas fa-chevron-circle-left"></i></a>
</div></nav>
<aside class="toc sidebar">
  <div class="sidebar-box">
    <div class="tools" role="navigation">
<ul>
<li class="tool edit"><a href="file:///Users/ianbridge/CouchbaseDocs/bau/sgw/modules/ROOT/pages/learn/authentication.adoc" title="Edit Page" target="_blank" rel="noopener">Edit on GitHub</a></li>
</ul>
</div>
    <div class="toc-menu"></div>
    <div class="is-this-helpful-box">
      <h4> Is this page helpful?</h4>
      <div class="btn-row">
        <a href="#" class="like-btn helpful-btn" id="yesBtn" data-page-rating="like" >
                <i class="far fa-thumbs-up"></i>
            Yes

            </a>
        <a href="#" class="dislike-btn helpful-btn" id="noBtn"  data-page-rating="dislike"> <i class="far fa-thumbs-down"></i> No</a>
      </div>
      <div class="any-feedback">
        <a href="#" class="btn any-feedback-btn" id="myCustomTrigger">Leave Additional Feedback? </a>
      </div>
      <div class="dialog-box" id="dialogBox">
        <form>
            <div class="form-group " id="additionalFeedbackBox">
              <textarea class="input-control feed-back-msg" rows="8" placeholder="Any Additonal Feedback?"></textarea>

              <div class="action-btn-row ">
                <a href="#" class="skip-btn" id="skipBtnMsg">Skip</a>
                  <button class="submit-btn btn blue-btn disabled" > Submit  </button>
                  <a href="#" class="info-btn"><i class="fas fa-info-circle"></i></a>
              </div>


            </div>

        </form>

      </div>
    </div>
  </div>

</aside>

<div class="feedback-modal modal-popup">
  <div class="modal-popup-dialogue">
    <div class="popup-header">
      <a href="#" class="close-popup"><i class="fa fa-times"></i></a>
    </div>
    <div class="popup-content">
      <p>
        Please use the form below to provide your feedback. Because your feedback is valuable to us,
         the information you submit in this form is recorded in our issue tracking system (JIRA), which is publicly available.
        You can track the status of your feedback using the ticket number displayed in the dialog once you submit the form.
      </p>
    </div>
  </div>
</div>

<main class="article" data-ceiling="topbar">
<div class="article-header">
<nav class="crumbs" aria-label="breadcrumbs">
<ul>
<li class="crumb"><a href="../index.html">Sync Gateway</a></li>
<li class="crumb">Security</li>
<li class="crumb"><a href="authentication.html">User Authentication</a></li>
</ul>
</nav>
</div>
<article class="doc">
<div class="page-heading-title">
<h1 class="page">User Authentication</h1>
</div>
<div class="contributor-list-box">
<span class="last-commit-date" id="commitdate">    </span>
<ul id="contributorList"></ul>
<span  id="otherContributor"> + </span>
</div><div id="preamble">
<div class="sectionbody">
<div class="quoteblock abstract">
<blockquote>
<div class="paragraph">
<p>Description&#8201;&#8212;&#8201;<em>Access Sync Gateway securely to sync from cloud to edge</em><br>
<em>Abstract&#8201;&#8212;&#8201;This content explains how to implement user authentication in Sync Gateway</em><br>
Related Content&#8201;&#8212;&#8201;<a href="../security.html" class="page">TLS Certificate Authentication</a>  |  <a href="defining-sync-functions.html" class="page">Sync Function</a>  |  <a href="../advance/adv-sgw-cfg-import-filter.html" class="page">Import filter</a>  |  <a href="read-access.html" class="page">Read Access</a>  |  <a href="write-access.html" class="page">Write Access</a></p>
</div>
</blockquote>
</div>
</div>
</div>
<div class="sect1">
<h2 id="introduction"><a class="anchor" href="#introduction"></a>Introduction</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Authentication is the process of verifying the identity of a user.
Sync Gateway supports the following authentication methods:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="#anonymous-access">Anonymous Access</a></dt>
<dd>
<p>Sync Gateway does not allow anonymous or guest access by default, but it can be enabled by editing the configuration file or by using the Admin REST API.</p>
</dd>
<dt class="hdlist1"><a href="#basic-authentication">Basic Authentication</a></dt>
<dd>
<p>Provide a username and password to authenticate users.</p>
</dd>
<dt class="hdlist1"><a href="#auth-providers">Auth Providers</a></dt>
<dd>
<p>Sync Gateway provides a turn-key solution to authenticate with Facebook or Google.<br>
For other providers we recommend to use Custom Authentication or OpenID Connect.</p>
<div class="openblock">
<div class="content">
<div class="ulist">
<ul>
<li>
<p><a href="#custom-authentication">Custom Authentication</a>
Use an App Server to handle the authentication yourself and create user sessions on the Sync Gateway Admin REST API.</p>
</li>
<li>
<p><a href="#openid-connect">OpenID Connect Authentication</a>
Use OpenID Connect providers (Google+, Paypal, etc.) to authenticate users.
Static providers: Sync Gateway currently supports authentication endpoints for Facebook, Google+ and OpenID Connect providers</p>
</li>
</ul>
</div>
</div>
</div>
</dd>
</dl>
</div>
</div>
</div>
<div class="sect1">
<h2 id="anonymous-access"><a class="anchor" href="#anonymous-access"></a>Anonymous Access</h2>
<div class="sectionbody">
<div class="paragraph">
<p>A special user account named <code>GUEST</code> applies to unauthenticated requests.
Any request to the Public REST API that does not have an <code>Authorization</code> header or a session cookie is treated as coming from the <code>GUEST</code> account.
This account and all anonymous access is disabled by default.</p>
</div>
<div class="paragraph">
<p>To enable the GUEST account, set its <code>disabled</code> property to false.
You might also want to give it access to some channels.
If you don&#8217;t assign some channels to the GUEST account, anonymous requests won&#8217;t be able to access any documents.
The following sample command enables the GUEST account and allows it access to a channel named public.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ curl -X PUT localhost:4985/$DB/_user/GUEST --data \
   '{"disabled":false, "admin_channels":["public"]}'</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="basic-authentication"><a class="anchor" href="#basic-authentication"></a>Basic Authentication</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Once the user has been created on Sync Gateway, you can provide the same <strong>username</strong>/<strong>password</strong> to the <code>BasicAuthenticator</code> class of Couchbase Lite.
Under the hood, the replicator will send the credentials in the first request to retrieve a <code>SyncGatewaySession</code> cookie and use it for all subsequent requests during the replication.
This is the recommended way of using basic authentication.</p>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="../../../couchbase-lite/2.8/swift/learn/swift-replication.html#basic-authentication" class="page">Swift</a></p>
</li>
<li>
<p><a href="../../../couchbase-lite/2.8/java/learn/java-replication.html#basic-authentication" class="page">Java</a></p>
</li>
<li>
<p><a href="../../../couchbase-lite/2.8/android/learn/java-android-replication.html#basic-authentication" class="page">Java (Android)</a></p>
</li>
<li>
<p><a href="../../../couchbase-lite/2.8/csharp/learn/csharp-replication.html#basic-authentication" class="page">C#</a></p>
</li>
<li>
<p><a href="../../../couchbase-lite/2.8/objc/learn/objc-replication.html#basic-authentication" class="page">Objective-C</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="auth-providers"><a class="anchor" href="#auth-providers"></a>Auth Providers</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Sync Gateway provides a turn-key solution to authenticate with Facebook or Google.</p>
</div>
<div class="paragraph">
<p>The app is responsible for retrieving the auth provider token and must send it to Sync Gateway which will return a session ID.
The session ID can be used to configure the Couchbase Lite replicator or for other HTTP requests to the Sync Gateway REST API.</p>
</div>
<div class="paragraph">
<p>The following diagram describes the sequence of steps.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/static-auth-provider.png" alt="static auth provider">
</div>
</div>
<div class="paragraph">
<p>API reference:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="../refer/rest-api-public.html#/auth/post__db___facebook" class="page">/{db}/_facebook</a></p>
</li>
<li>
<p><a href="../refer/rest-api-public.html#/auth/post__db___google" class="page">/{db}/_google</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For other providers we recommend to use Custom Authentication or OpenID Connect.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="custom-authentication"><a class="anchor" href="#custom-authentication"></a>Custom Authentication</h2>
<div class="sectionbody">
<div class="paragraph">
<p>It&#8217;s possible for an application server associated with a remote Couchbase Sync Gateway to provide its own custom form of authentication.
Generally this will involve a particular URL that the app needs to post some form of credentials to;
the App Server will verify those, then tell the Sync Gateway to create a new session for the corresponding user, and return session credentials in its response to the client app.</p>
</div>
<div class="paragraph">
<p>The following diagram shows an example architecture to support Google SignIn in a Couchbase Mobile application, the client sends an access token to the App Server where a server side validation is done with the Google API and a corresponding Sync Gateway user is then created if it&#8217;s the first time the user logs in.
The last request creates a session.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/custom-auth-flow.png" alt="custom auth flow">
</div>
</div>
<div class="paragraph">
<p>Given a user that has already been created, a new session for that user can be created on the Admin <a href="../refer/rest-api-admin.html#/session/post__db___session" class="page">POST /{db}/_session</a> endpoint.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ curl -vX POST -H 'Content-Type: application/json' \
        -d '{"name": "john", "ttl": 180}' \
        http://localhost:4985/sync_gateway/_session
// Response message body
{
  "session_id": "904ac010862f37c8dd99015a33ab5a3565fd8447",
  "expires": "2015-09-23T17:27:17.555065803+01:00",
  "cookie_name": "SyncGatewaySession"
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The HTTP response body contains the credentials of the session.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>name</strong> corresponds to the <code>cookie_name</code></p>
</li>
<li>
<p><strong>value</strong> corresponds to the <code>session_id</code></p>
</li>
<li>
<p><strong>path</strong> is the hostname of the Sync Gateway</p>
</li>
<li>
<p><strong>expirationDate</strong> corresponds to the cookie&#8217;s expiration time. The endpoint&#8217;s <a href="../refer/rest-api-admin.html#/session/post__db___session" class="page">API reference</a> contains more information about how the expiration time is automatically extended according to the user session activity.</p>
</li>
<li>
<p><strong>secure</strong> Whether the cookie should only be sent using a secure protocol (e.g. HTTPS)</p>
</li>
<li>
<p><strong>httpOnly</strong> Whether the cookie should only be used when transmitting HTTP, or HTTPS, requests thus restricting access from other, non-HTTP APIs</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>It is recommended to return the session details to the client application in the same form and to use the <code>SessionAuthenticator</code> class to authenticate with that session id.</p>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="../../../couchbase-lite/2.8/swift/learn/swift-replication.html#session-authentication" class="page">Swift</a></p>
</li>
<li>
<p><a href="../../../couchbase-lite/2.8/objc/learn/objc-replication.html#session-authentication" class="page">Objective-C</a></p>
</li>
<li>
<p><a href="../../../couchbase-lite/2.8/java/learn/java-replication.html#session-authentication" class="page">Java</a></p>
</li>
<li>
<p><a href="../../../couchbase-lite/2.8/android/learn/java-android-replication.html#session-authentication" class="page">Android (Java)</a></p>
</li>
<li>
<p><a href="../../../couchbase-lite/2.8/csharp/learn/csharp-replication.html#session-authentication" class="page">C#</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="openid-connect"><a class="anchor" href="#openid-connect"></a>OpenID Connect</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Sync Gateway supports OpenID Connect.
This allows your application to use Couchbase for data synchronization and delegate the authentication to a 3rd party server (known as the Provider).
There are two implementation methods available with OpenID Connect:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="#implicit-flow">Implicit Flow</a></dt>
<dd>
<p>With this method, the retrieval of the ID token takes place on the device.
You can then create a user session using the POST <code>/{tkn-db}/_session</code> endpoint on the Public REST API with the ID token.</p>
</dd>
<dt class="hdlist1"><a href="#authorization-code-flow">Authorization Code Flow</a></dt>
<dd>
<p>This method relies on Sync Gateway to retrieve the ID token.</p>
</dd>
</dl>
</div>
<div class="sect2">
<h3 id="implicit-flow"><a class="anchor" href="#implicit-flow"></a>Implicit Flow</h3>
<div class="paragraph">
<p><a href="https://openid.net/specs/openid-connect-core-1_0.html#ImplicitFlowAuth">Implicit Flow</a> has the key feature of allowing clients to obtain their own Open ID token and use it to authenticate against Sync Gateway.
The implicit flow with Sync Gateway is as follows:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The client obtains a <strong>signed</strong> Open ID token directly from an OpenID Connect provider. Note that only signed tokens are supported.
To verify that the Open ID token being sent is indeed signed, you can use the <a href="https://jwt.io/#debugger-io">jwt.io Debugger</a>.
In the algorithm dropdown, make sure to select <code>RS256</code> as the signing algorithm (other options such as <code>HS256</code> are not yet supported by Sync Gateway).</p>
</li>
<li>
<p>The client includes the Open ID token as an <code>Authorization: Bearer &lt;id_token&gt;</code> header on requests made against the Sync Gateway REST API.</p>
</li>
<li>
<p>Sync Gateway matches the token to a provider in its configuration file based on the issuer and audience in the token.</p>
</li>
<li>
<p>Sync Gateway validates the token, based on the provider definition.</p>
</li>
<li>
<p>Upon successful validation, Sync Gateway authenticates the user based on the subject and issuer in the token.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Since Open ID tokens are typically large, the usual approach is to use the Open ID token to obtain a Sync Gateway session id (using the <a href="../refer/rest-api-public.html#/session/post__db___session" class="page">POST /db/_session</a> endpoint), and then use the returned session id for subsequent authentication requests.</p>
</div>
<div class="paragraph">
<p>Here is a sample Sync Gateway config file, configured to use the Implicit Flow.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">{
  "interface":":4984",
  "log":["*"],
  "databases": {
    "default": {
      "server": "http://localhost:8091",
      "bucket": "default",
      "oidc": {
        "providers": {
          "google_implicit": {
            "issuer":"https://accounts.google.com",
            "client_id":"yourclientid-uso.apps.googleusercontent.com",
            "register":true
          },
        },
      }
    }
  }
}</code></pre>
</div>
</div>
<div class="sect3">
<h4 id="client-authentication"><a class="anchor" href="#client-authentication"></a>Client Authentication</h4>
<div class="paragraph">
<p>With the implicit flow, the mechanism to refresh the token and Sync Gateway session must be handled in the application code.
On launch, the application should check if the token has expired.
If it has then you must request a new token (Google SignIn for iOS has a method called <code>signInSilently</code> for this purpose).
By doing this, the application can then use the token to create a Sync Gateway session.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/client-auth.png" alt="client auth">
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The Google SignIn SDK prompts the user to login and if successful it returns an ID token to the application.</p>
</li>
<li>
<p>The ID token is used to create a Sync Gateway session by sending a POST <code>/{tkn-db}/_session</code> request.</p>
</li>
<li>
<p>Sync Gateway returns a cookie session in the response header.</p>
</li>
<li>
<p>The Sync Gateway cookie session is used on the replicator object.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Sync Gateway sessions also have an expiration date.
The replication <code>lastError</code> property will return a <strong>401 Unauthorized</strong> when it&#8217;s the case and then the application must retrieve create a new Sync Gateway session and set the new cookie on the replicator.</p>
</div>
<div class="paragraph">
<p>A complete tutorial is available <a href="https://docs.couchbase.com/tutorials/openid-connect-implicit-flow/index.html">here</a> for your reference.</p>
</div>
<div class="paragraph">
<p>You can configure your application for Google SignIn by following <a href="https://developers.google.com/identity/">this guide</a>.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="authorization-code-flow"><a class="anchor" href="#authorization-code-flow"></a>Authorization Code Flow</h3>
<div class="paragraph">
<p>Whilst Sync Gateway supports <a href="https://openid.net/specs/openid-connect-core-1_0.html#CodeFlowAuth">Authorization Code Flow</a>, there is considerable work involved to implement the <strong>Authorization Code Flow</strong> on the client side.
Couchbase Lite 1.x has an API to hide this complexity called <code>OpenIDConnectAuthenticator</code> but since it is not available in the 2.0 API we recommend to use the <strong>Implicit Flow</strong>.</p>
</div>
</div>
</div>
</div>
</article>
</main>
</div>
<footer class="footer">
  <div class="container">
    <div class="footer-links">
      <div class="col">
        <div class="footer-logo">
          <a href="https://www.couchbase.com" class="icon">
            <img src="../../../_/img/couchbase_logo_black.svg" alt="Couchbase">
          </a>
        </div>
      </div>
      <div class="col">
        <ul>
          <li><a href="https://docs.couchbase.com" target="_blank" rel="noopener">Documentation</a></li>
          <li><a href="https://forums.couchbase.com" target="_blank" rel="noopener">Forums</a></li>
          <li><a href="https://support.couchbase.com" target="_blank" rel="noopener">Support</a></li>
        </ul>
      </div>
      <div class="col">
        <ul>
          <li><a href="https://developer.couchbase.com" target="_blank" rel="noopener">Developer Portal</a></li>
          <li><a href="https://blog.couchbase.com" target="_blank" rel="noopener">Blog</a></li>
          <li><a href="https://www.couchbase.com/resources">Resources</a></li>
        </ul>
      </div>
      <div class="col">
        <ul>
          <li><a href="https://www.couchbase.com/get-started-developing-nosql">Get Started</a></li>
          <li><a href="https://www.couchbase.com/downloads">Downloads</a></li>
          <li><a href="https://learn.couchbase.com/store?utf8=%E2%9C%93&ss=1&ct=78327&commit=Filter" target="_blank" rel="noopener">Training</a></li>
        </ul>
      </div>
      <div class="col">
        <ul class="social-icons">
          <li>
            <svg  width="14" height="14" viewBox="0 0 32 32"> <path id="facebook" class="cls-1" d="M29,0H3A2.652,2.652,0,0,0,0,3V29a2.652,2.652,0,0,0,3,3H16V18H12V14h4V12a6.452,6.452,0,0,1,6-6h4v4H22a2.151,2.151,0,0,0-2,2v2h6l-1,4H20V32h9a2.652,2.652,0,0,0,3-3V3A2.652,2.652,0,0,0,29,0Z"/></svg>
            <a href="https://www.facebook.com/Couchbase" class="icon">
            Facebook
            </a>
          </li>
          <li>
            <svg  width="14" height="14" viewBox="0 0 32.1 26.1"> <path id="twitter" class="cls-1" d="M32,7.1a11.836,11.836,0,0,1-3.8,1,6.462,6.462,0,0,0,2.9-3.6,12.606,12.606,0,0,1-4.2,1.6A6.492,6.492,0,0,0,22.1,4a6.594,6.594,0,0,0-6.6,6.6,7.719,7.719,0,0,0,.2,1.5A18.458,18.458,0,0,1,2.2,5.2a6.294,6.294,0,0,0-.9,3.3A6.765,6.765,0,0,0,4.2,14a6.109,6.109,0,0,1-3-.8v.1a6.543,6.543,0,0,0,5.3,6.4,4.678,4.678,0,0,1-1.7.2,4.869,4.869,0,0,1-1.2-.1,6.679,6.679,0,0,0,6.1,4.6,12.917,12.917,0,0,1-8.2,2.8,9.151,9.151,0,0,1-1.6-.1,18.438,18.438,0,0,0,10.1,3c12.1,0,18.7-10,18.7-18.7v-.8A13.336,13.336,0,0,0,32,7.2Z" transform="translate(0.1 -4)"/></svg>
            <a href="https://twitter.com/couchbase" class="icon">
              Twitter
            </a>
          </li>
          <li>
          <svg  width="14" height="14" viewBox="0 0 32 32"> <path id="linkedin" class="cls-1" d="M29,0H3A3.076,3.076,0,0,0,0,3V29a3.009,3.009,0,0,0,3,3H29a2.946,2.946,0,0,0,3-3V3A3.009,3.009,0,0,0,29,0ZM12,26H8V12h4ZM10,10a2,2,0,1,1,2-2A2.006,2.006,0,0,1,10,10ZM26,26H22V18a2,2,0,0,0-4,0v8H14V12h4v2.5c.8-1.1,2.1-2.5,3.5-2.5A4.736,4.736,0,0,1,26,17Z"/></svg>
              <a href="https://www.linkedin.com/company/couchbase" class="icon">
             Linkedin
            </a>
          </li>
        </ul>
      </div>
    </div>
    <div class="footer-terms">
      <div class="footer-terms-copyright">
          <span>Â© 2021 Couchbase, Inc. Couchbase, Couchbase Lite and the Couchbase logo are registered trademarks of Couchbase, Inc.</span>
      </div>
      <div class="footer-terms-links">
        <a href="https://www.couchbase.com/terms-of-use">Terms of Use</a>
        <a href="https://www.couchbase.com/privacy-policy">Privacy Policy</a>
        <a href="https://www.couchbase.com/cookie-policy">Cookie Policy</a>
        <a href="https://www.couchbase.com/support-policy">Support Policy</a>
        <a href="https://info.couchbase.com/unsubscribe-or-manage-preferences.html" target="_blank" rel="noopener">Marketing Preference Center</a>
      </div>
    </div>
  </div>
</footer>
<script src="../../../_/js/site.js"></script>
<script async src="../../../_/js/vendor/fontawesome-icon-defs.js"></script>
<script async src="../../../_/js/vendor/fontawesome.js"></script>
<script async src="../../../_/js/vendor/highlight.js"></script>
</body>
</html>
